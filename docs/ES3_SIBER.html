<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ES: Enríquez-García - 3&nbsp; Amplitudes and comparisons of the isotopic niches</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ES4_nicheROVER.html" rel="next">
<link href="./ES2_BHGLM.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Amplitudes and comparisons of the isotopic niches</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">ES: Enríquez-García</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ArturoBell/01072022" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Index</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ES1_ML_counts.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">ML approach to classify species based on prey counts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ES2_BHGLM.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Hierarchical Bayesian Models to describe differences in isotopic values between and within species</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ES3_SIBER.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Amplitudes and comparisons of the isotopic niches</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ES4_nicheROVER.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Isotopic niche overlaps</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#libraries" id="toc-libraries" class="nav-link active" data-scroll-target="#libraries"><span class="toc-section-number">3.1</span>  Libraries</a></li>
  <li><a href="#data-loading" id="toc-data-loading" class="nav-link" data-scroll-target="#data-loading"><span class="toc-section-number">3.2</span>  Data loading</a></li>
  <li><a href="#global-siber" id="toc-global-siber" class="nav-link" data-scroll-target="#global-siber"><span class="toc-section-number">3.3</span>  “Global” SIBER:</a>
  <ul class="collapse">
  <li><a href="#dataset-arrangement" id="toc-dataset-arrangement" class="nav-link" data-scroll-target="#dataset-arrangement"><span class="toc-section-number">3.3.1</span>  Dataset arrangement</a></li>
  <li><a href="#basic-plot" id="toc-basic-plot" class="nav-link" data-scroll-target="#basic-plot"><span class="toc-section-number">3.3.2</span>  Basic plot</a></li>
  <li><a href="#fitting-the-bayesian-bi-variate-normal-models" id="toc-fitting-the-bayesian-bi-variate-normal-models" class="nav-link" data-scroll-target="#fitting-the-bayesian-bi-variate-normal-models"><span class="toc-section-number">3.3.3</span>  Fitting the Bayesian Bi-variate Normal models:</a></li>
  </ul></li>
  <li><a href="#intra-specific-analyses" id="toc-intra-specific-analyses" class="nav-link" data-scroll-target="#intra-specific-analyses"><span class="toc-section-number">3.4</span>  Intra-specific analyses</a>
  <ul class="collapse">
  <li><a href="#custom-wrapper-around-siber" id="toc-custom-wrapper-around-siber" class="nav-link" data-scroll-target="#custom-wrapper-around-siber"><span class="toc-section-number">3.4.1</span>  Custom wrapper around SIBER:</a></li>
  <li><a href="#sex" id="toc-sex" class="nav-link" data-scroll-target="#sex"><span class="toc-section-number">3.4.2</span>  Sex</a></li>
  <li><a href="#age" id="toc-age" class="nav-link" data-scroll-target="#age"><span class="toc-section-number">3.4.3</span>  Age</a></li>
  <li><a href="#season" id="toc-season" class="nav-link" data-scroll-target="#season"><span class="toc-section-number">3.4.4</span>  Season</a></li>
  <li><a href="#final-forestplot" id="toc-final-forestplot" class="nav-link" data-scroll-target="#final-forestplot"><span class="toc-section-number">3.4.5</span>  Final forestplot:</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/ArturoBell/01072022/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Amplitudes and comparisons of the isotopic niches</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="libraries" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="libraries"><span class="header-section-number">3.1</span> Libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SIBER)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggConvexHull)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HDInterval)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mcmcplots)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmcmc)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MCMCvis)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-loading" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="data-loading"><span class="header-section-number">3.2</span> Data loading</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"data/glm.csv"</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> T)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data)[<span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"iso1"</span>, <span class="st">"iso2"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["sp"],"name":[1],"type":["chr"],"align":["left"]},{"label":["year"],"name":[2],"type":["int"],"align":["right"]},{"label":["temporada"],"name":[3],"type":["chr"],"align":["left"]},{"label":["sexo"],"name":[4],"type":["chr"],"align":["left"]},{"label":["estadio"],"name":[5],"type":["chr"],"align":["left"]},{"label":["iso1"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["iso2"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"H.dipterurus","2":"2015","3":"Calida","4":"M","5":"Juvenil","6":"16.30122","7":"-14.50678","_rn_":"1"},{"1":"H.dipterurus","2":"2015","3":"Calida","4":"H","5":"Juvenil","6":"16.83237","7":"-17.81040","_rn_":"2"},{"1":"H.dipterurus","2":"2015","3":"Calida","4":"M","5":"Adulto","6":"17.13546","7":"-15.83143","_rn_":"3"},{"1":"H.dipterurus","2":"2015","3":"Calida","4":"H","5":"Juvenil","6":"13.12309","7":"-15.96596","_rn_":"4"},{"1":"H.dipterurus","2":"2015","3":"Calida","4":"M","5":"Adulto","6":"17.63312","7":"-16.71944","_rn_":"5"},{"1":"H.dipterurus","2":"2015","3":"Calida","4":"H","5":"Juvenil","6":"17.59479","7":"-16.89169","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="global-siber" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="global-siber"><span class="header-section-number">3.3</span> “Global” SIBER:</h2>
<section id="dataset-arrangement" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="dataset-arrangement"><span class="header-section-number">3.3.1</span> Dataset arrangement</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>global <span class="ot">&lt;-</span> <span class="fu">subset</span>(data, <span class="at">select =</span> <span class="fu">c</span>(sp, iso1, iso2))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>global<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(global<span class="sc">$</span>sp, <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>global<span class="sc">$</span>community <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>global</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["sp"],"name":[1],"type":["chr"],"align":["left"]},{"label":["iso1"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["iso2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["group"],"name":[4],"type":["fct"],"align":["left"]},{"label":["community"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"H.dipterurus","2":"16.30122","3":"-14.506785","4":"1","5":"1","_rn_":"1"},{"1":"H.dipterurus","2":"16.83237","3":"-17.810405","4":"1","5":"1","_rn_":"2"},{"1":"H.dipterurus","2":"17.13546","3":"-15.831434","4":"1","5":"1","_rn_":"3"},{"1":"H.dipterurus","2":"13.12309","3":"-15.965960","4":"1","5":"1","_rn_":"4"},{"1":"H.dipterurus","2":"17.63312","3":"-16.719438","4":"1","5":"1","_rn_":"5"},{"1":"H.dipterurus","2":"17.59479","3":"-16.891687","4":"1","5":"1","_rn_":"6"},{"1":"H.dipterurus","2":"17.38576","3":"-17.775261","4":"1","5":"1","_rn_":"7"},{"1":"H.dipterurus","2":"17.53165","3":"-16.483062","4":"1","5":"1","_rn_":"8"},{"1":"H.dipterurus","2":"17.36609","3":"-14.911497","4":"1","5":"1","_rn_":"9"},{"1":"H.dipterurus","2":"17.15074","3":"-16.719575","4":"1","5":"1","_rn_":"10"},{"1":"H.dipterurus","2":"16.61558","3":"-16.752129","4":"1","5":"1","_rn_":"11"},{"1":"H.dipterurus","2":"17.35064","3":"-17.639349","4":"1","5":"1","_rn_":"12"},{"1":"H.dipterurus","2":"17.62361","3":"-16.368698","4":"1","5":"1","_rn_":"13"},{"1":"H.dipterurus","2":"16.37983","3":"-14.688148","4":"1","5":"1","_rn_":"14"},{"1":"H.dipterurus","2":"15.98897","3":"-12.776352","4":"1","5":"1","_rn_":"15"},{"1":"H.dipterurus","2":"16.86170","3":"-13.262567","4":"1","5":"1","_rn_":"16"},{"1":"H.dipterurus","2":"18.51718","3":"-14.716483","4":"1","5":"1","_rn_":"17"},{"1":"H.dipterurus","2":"16.04560","3":"-12.769006","4":"1","5":"1","_rn_":"18"},{"1":"H.dipterurus","2":"16.49364","3":"-14.452771","4":"1","5":"1","_rn_":"19"},{"1":"H.dipterurus","2":"15.92453","3":"-13.630355","4":"1","5":"1","_rn_":"20"},{"1":"H.dipterurus","2":"15.39649","3":"-12.625105","4":"1","5":"1","_rn_":"21"},{"1":"H.dipterurus","2":"14.84788","3":"-12.846357","4":"1","5":"1","_rn_":"22"},{"1":"H.dipterurus","2":"16.30861","3":"-12.570448","4":"1","5":"1","_rn_":"23"},{"1":"H.dipterurus","2":"17.04530","3":"-14.440304","4":"1","5":"1","_rn_":"24"},{"1":"H.dipterurus","2":"17.28246","3":"-16.149711","4":"1","5":"1","_rn_":"25"},{"1":"H.dipterurus","2":"17.31708","3":"-15.905564","4":"1","5":"1","_rn_":"26"},{"1":"H.dipterurus","2":"17.09274","3":"-12.059360","4":"1","5":"1","_rn_":"27"},{"1":"H.dipterurus","2":"17.61104","3":"-11.432828","4":"1","5":"1","_rn_":"28"},{"1":"H.dipterurus","2":"16.57466","3":"-13.449599","4":"1","5":"1","_rn_":"29"},{"1":"H.dipterurus","2":"14.62984","3":"-11.744879","4":"1","5":"1","_rn_":"30"},{"1":"H.dipterurus","2":"15.73491","3":"-13.475159","4":"1","5":"1","_rn_":"31"},{"1":"H.dipterurus","2":"16.49596","3":"-14.076257","4":"1","5":"1","_rn_":"32"},{"1":"H.dipterurus","2":"18.48210","3":"-14.636347","4":"1","5":"1","_rn_":"33"},{"1":"H.dipterurus","2":"12.34368","3":"-9.828568","4":"1","5":"1","_rn_":"34"},{"1":"H.dipterurus","2":"18.00107","3":"-17.429800","4":"1","5":"1","_rn_":"35"},{"1":"H.dipterurus","2":"16.75774","3":"-15.292624","4":"1","5":"1","_rn_":"36"},{"1":"H.dipterurus","2":"12.52192","3":"-13.240223","4":"1","5":"1","_rn_":"37"},{"1":"H.dipterurus","2":"16.91399","3":"-16.169596","4":"1","5":"1","_rn_":"38"},{"1":"H.dipterurus","2":"16.13277","3":"-13.344244","4":"1","5":"1","_rn_":"39"},{"1":"H.dipterurus","2":"15.47293","3":"-12.370325","4":"1","5":"1","_rn_":"40"},{"1":"H.dipterurus","2":"12.66946","3":"-9.521133","4":"1","5":"1","_rn_":"41"},{"1":"H.dipterurus","2":"14.18410","3":"-10.005460","4":"1","5":"1","_rn_":"42"},{"1":"H.dipterurus","2":"14.97596","3":"-14.757380","4":"1","5":"1","_rn_":"43"},{"1":"H.dipterurus","2":"17.65270","3":"-16.505861","4":"1","5":"1","_rn_":"44"},{"1":"H.dipterurus","2":"18.30527","3":"-16.392231","4":"1","5":"1","_rn_":"45"},{"1":"H.dipterurus","2":"13.47288","3":"-11.472878","4":"1","5":"1","_rn_":"46"},{"1":"H.dipterurus","2":"16.08561","3":"-14.016817","4":"1","5":"1","_rn_":"47"},{"1":"H.dipterurus","2":"16.15862","3":"-13.841703","4":"1","5":"1","_rn_":"48"},{"1":"H.dipterurus","2":"13.70919","3":"-12.482433","4":"1","5":"1","_rn_":"49"},{"1":"H.dipterurus","2":"15.98453","3":"-10.935686","4":"1","5":"1","_rn_":"50"},{"1":"H.dipterurus","2":"18.03568","3":"-14.988565","4":"1","5":"1","_rn_":"51"},{"1":"H.dipterurus","2":"17.30072","3":"-14.606490","4":"1","5":"1","_rn_":"52"},{"1":"H.dipterurus","2":"13.16290","3":"-17.955144","4":"1","5":"1","_rn_":"53"},{"1":"H.dipterurus","2":"17.90422","3":"-13.937062","4":"1","5":"1","_rn_":"54"},{"1":"H.dipterurus","2":"16.73228","3":"-13.980794","4":"1","5":"1","_rn_":"55"},{"1":"H.dipterurus","2":"13.09883","3":"-11.530560","4":"1","5":"1","_rn_":"56"},{"1":"H.dipterurus","2":"15.24944","3":"-14.619800","4":"1","5":"1","_rn_":"57"},{"1":"H.dipterurus","2":"18.85103","3":"-14.074706","4":"1","5":"1","_rn_":"58"},{"1":"H.dipterurus","2":"18.30112","3":"-15.224259","4":"1","5":"1","_rn_":"59"},{"1":"H.dipterurus","2":"15.24944","3":"-14.619800","4":"1","5":"1","_rn_":"60"},{"1":"H.dipterurus","2":"17.28863","3":"-13.621352","4":"1","5":"1","_rn_":"61"},{"1":"H.dipterurus","2":"14.52942","3":"-11.910928","4":"1","5":"1","_rn_":"62"},{"1":"H.dipterurus","2":"16.09398","3":"-13.450398","4":"1","5":"1","_rn_":"63"},{"1":"H.dipterurus","2":"12.00595","3":"-10.740938","4":"1","5":"1","_rn_":"64"},{"1":"H.dipterurus","2":"13.49739","3":"-13.332209","4":"1","5":"1","_rn_":"65"},{"1":"H.dipterurus","2":"16.67906","3":"-13.366049","4":"1","5":"1","_rn_":"66"},{"1":"H.dipterurus","2":"13.66544","3":"-13.087089","4":"1","5":"1","_rn_":"67"},{"1":"H.dipterurus","2":"15.06453","3":"-15.237497","4":"1","5":"1","_rn_":"68"},{"1":"H.dipterurus","2":"15.32159","3":"-15.571709","4":"1","5":"1","_rn_":"69"},{"1":"H.dipterurus","2":"13.74616","3":"-11.784672","4":"1","5":"1","_rn_":"70"},{"1":"H.dipterurus","2":"13.50130","3":"-11.651279","4":"1","5":"1","_rn_":"71"},{"1":"H.dipterurus","2":"17.26645","3":"-12.881933","4":"1","5":"1","_rn_":"72"},{"1":"H.dipterurus","2":"16.13517","3":"-10.488815","4":"1","5":"1","_rn_":"73"},{"1":"H.dipterurus","2":"14.40338","3":"-12.797947","4":"1","5":"1","_rn_":"74"},{"1":"H.dipterurus","2":"13.74533","3":"-11.261025","4":"1","5":"1","_rn_":"75"},{"1":"H.dipterurus","2":"14.12132","3":"-13.307271","4":"1","5":"1","_rn_":"76"},{"1":"H.dipterurus","2":"14.85045","3":"-12.454063","4":"1","5":"1","_rn_":"77"},{"1":"H.dipterurus","2":"13.86837","3":"-12.638109","4":"1","5":"1","_rn_":"78"},{"1":"H.dipterurus","2":"15.91657","3":"-18.192198","4":"1","5":"1","_rn_":"79"},{"1":"H.dipterurus","2":"15.11890","3":"-13.249384","4":"1","5":"1","_rn_":"80"},{"1":"H.dipterurus","2":"11.33558","3":"-12.135309","4":"1","5":"1","_rn_":"81"},{"1":"N.entemedor","2":"18.06496","3":"-12.576861","4":"2","5":"1","_rn_":"82"},{"1":"N.entemedor","2":"19.24809","3":"-12.387746","4":"2","5":"1","_rn_":"83"},{"1":"N.entemedor","2":"18.43830","3":"-13.206207","4":"2","5":"1","_rn_":"84"},{"1":"N.entemedor","2":"18.68236","3":"-13.093984","4":"2","5":"1","_rn_":"85"},{"1":"N.entemedor","2":"18.80796","3":"-15.040046","4":"2","5":"1","_rn_":"86"},{"1":"N.entemedor","2":"18.44630","3":"-12.307636","4":"2","5":"1","_rn_":"87"},{"1":"N.entemedor","2":"18.77393","3":"-13.342379","4":"2","5":"1","_rn_":"88"},{"1":"N.entemedor","2":"18.74693","3":"-12.992151","4":"2","5":"1","_rn_":"89"},{"1":"N.entemedor","2":"18.73737","3":"-13.320279","4":"2","5":"1","_rn_":"90"},{"1":"N.entemedor","2":"18.34188","3":"-13.021170","4":"2","5":"1","_rn_":"91"},{"1":"N.entemedor","2":"18.21270","3":"-13.738381","4":"2","5":"1","_rn_":"92"},{"1":"N.entemedor","2":"18.06269","3":"-12.700124","4":"2","5":"1","_rn_":"93"},{"1":"N.entemedor","2":"18.35471","3":"-13.256262","4":"2","5":"1","_rn_":"94"},{"1":"N.entemedor","2":"18.43918","3":"-12.830356","4":"2","5":"1","_rn_":"95"},{"1":"N.entemedor","2":"18.49797","3":"-12.592452","4":"2","5":"1","_rn_":"96"},{"1":"N.entemedor","2":"18.53388","3":"-14.709884","4":"2","5":"1","_rn_":"97"},{"1":"N.entemedor","2":"17.74805","3":"-11.308808","4":"2","5":"1","_rn_":"98"},{"1":"N.entemedor","2":"17.06800","3":"-10.721713","4":"2","5":"1","_rn_":"99"},{"1":"N.entemedor","2":"17.87917","3":"-13.139164","4":"2","5":"1","_rn_":"100"},{"1":"N.entemedor","2":"17.89406","3":"-11.135780","4":"2","5":"1","_rn_":"101"},{"1":"N.entemedor","2":"18.53532","3":"-11.703252","4":"2","5":"1","_rn_":"102"},{"1":"N.entemedor","2":"18.79593","3":"-12.813034","4":"2","5":"1","_rn_":"103"},{"1":"N.entemedor","2":"18.50925","3":"-14.550331","4":"2","5":"1","_rn_":"104"},{"1":"N.entemedor","2":"17.88813","3":"-12.262318","4":"2","5":"1","_rn_":"105"},{"1":"N.entemedor","2":"18.18886","3":"-12.521845","4":"2","5":"1","_rn_":"106"},{"1":"N.entemedor","2":"18.56173","3":"-12.594098","4":"2","5":"1","_rn_":"107"},{"1":"N.entemedor","2":"18.85613","3":"-14.281614","4":"2","5":"1","_rn_":"108"},{"1":"N.entemedor","2":"19.24915","3":"-14.651350","4":"2","5":"1","_rn_":"109"},{"1":"N.entemedor","2":"18.90475","3":"-12.668116","4":"2","5":"1","_rn_":"110"},{"1":"N.entemedor","2":"18.51618","3":"-14.194448","4":"2","5":"1","_rn_":"111"},{"1":"N.entemedor","2":"16.91905","3":"-11.654277","4":"2","5":"1","_rn_":"112"},{"1":"N.entemedor","2":"16.33095","3":"-10.870737","4":"2","5":"1","_rn_":"113"},{"1":"N.entemedor","2":"17.47080","3":"-12.121371","4":"2","5":"1","_rn_":"114"},{"1":"N.entemedor","2":"16.81504","3":"-12.015301","4":"2","5":"1","_rn_":"115"},{"1":"N.entemedor","2":"16.81369","3":"-11.494263","4":"2","5":"1","_rn_":"116"},{"1":"N.entemedor","2":"18.89413","3":"-12.082934","4":"2","5":"1","_rn_":"117"},{"1":"N.entemedor","2":"18.54066","3":"-12.326045","4":"2","5":"1","_rn_":"118"},{"1":"N.entemedor","2":"17.93769","3":"-12.407061","4":"2","5":"1","_rn_":"119"},{"1":"N.entemedor","2":"17.88269","3":"-12.444068","4":"2","5":"1","_rn_":"120"},{"1":"N.entemedor","2":"18.73265","3":"-12.245029","4":"2","5":"1","_rn_":"121"},{"1":"N.entemedor","2":"18.14168","3":"-12.663111","4":"2","5":"1","_rn_":"122"},{"1":"N.entemedor","2":"18.06568","3":"-12.400059","4":"2","5":"1","_rn_":"123"},{"1":"N.entemedor","2":"18.34867","3":"-12.330046","4":"2","5":"1","_rn_":"124"},{"1":"N.entemedor","2":"18.24405","3":"-11.875593","4":"2","5":"1","_rn_":"125"},{"1":"N.entemedor","2":"18.02808","3":"-11.947600","4":"2","5":"1","_rn_":"126"},{"1":"N.entemedor","2":"17.16921","3":"-10.541466","4":"2","5":"1","_rn_":"127"},{"1":"N.entemedor","2":"18.18405","3":"-14.082804","4":"2","5":"1","_rn_":"128"},{"1":"N.entemedor","2":"18.06607","3":"-11.658572","4":"2","5":"1","_rn_":"129"},{"1":"N.entemedor","2":"15.09241","3":"-10.532098","4":"2","5":"1","_rn_":"130"},{"1":"N.entemedor","2":"17.03229","3":"-11.026491","4":"2","5":"1","_rn_":"131"},{"1":"N.entemedor","2":"16.11416","3":"-9.564361","4":"2","5":"1","_rn_":"132"},{"1":"N.entemedor","2":"18.11307","3":"-11.325541","4":"2","5":"1","_rn_":"133"},{"1":"N.entemedor","2":"17.64769","3":"-11.192531","4":"2","5":"1","_rn_":"134"},{"1":"N.entemedor","2":"17.03343","3":"-13.462272","4":"2","5":"1","_rn_":"135"},{"1":"N.entemedor","2":"15.96660","3":"-10.926468","4":"2","5":"1","_rn_":"136"},{"1":"N.entemedor","2":"17.00342","3":"-10.409776","4":"2","5":"1","_rn_":"137"},{"1":"N.entemedor","2":"18.27210","3":"-12.314798","4":"2","5":"1","_rn_":"138"},{"1":"N.entemedor","2":"17.69763","3":"-13.364224","4":"2","5":"1","_rn_":"139"},{"1":"N.entemedor","2":"16.72491","3":"-11.213941","4":"2","5":"1","_rn_":"140"},{"1":"N.entemedor","2":"18.16624","3":"-11.850346","4":"2","5":"1","_rn_":"141"},{"1":"N.entemedor","2":"16.83670","3":"-11.798375","4":"2","5":"1","_rn_":"142"},{"1":"N.entemedor","2":"17.16674","3":"-12.478817","4":"2","5":"1","_rn_":"143"},{"1":"N.entemedor","2":"18.05469","3":"-11.698876","4":"2","5":"1","_rn_":"144"},{"1":"N.entemedor","2":"17.68666","3":"-11.894924","4":"2","5":"1","_rn_":"145"},{"1":"N.entemedor","2":"17.75412","3":"-11.681279","4":"2","5":"1","_rn_":"146"},{"1":"N.entemedor","2":"18.47296","3":"-12.638460","4":"2","5":"1","_rn_":"147"},{"1":"N.entemedor","2":"18.19192","3":"-12.477432","4":"2","5":"1","_rn_":"148"},{"1":"N.entemedor","2":"18.35903","3":"-13.937790","4":"2","5":"1","_rn_":"149"},{"1":"N.entemedor","2":"17.38079","3":"-11.847324","4":"2","5":"1","_rn_":"150"},{"1":"R.steindachneri","2":"16.42357","3":"-16.308019","4":"3","5":"1","_rn_":"151"},{"1":"R.steindachneri","2":"15.44596","3":"-15.745392","4":"3","5":"1","_rn_":"152"},{"1":"R.steindachneri","2":"16.36962","3":"-16.264082","4":"3","5":"1","_rn_":"153"},{"1":"R.steindachneri","2":"16.37656","3":"-16.595090","4":"3","5":"1","_rn_":"154"},{"1":"R.steindachneri","2":"16.18079","3":"-15.950950","4":"3","5":"1","_rn_":"155"},{"1":"R.steindachneri","2":"16.40396","3":"-16.253609","4":"3","5":"1","_rn_":"156"},{"1":"R.steindachneri","2":"15.76095","3":"-16.523605","4":"3","5":"1","_rn_":"157"},{"1":"R.steindachneri","2":"14.87549","3":"-15.458638","4":"3","5":"1","_rn_":"158"},{"1":"R.steindachneri","2":"16.41601","3":"-16.627612","4":"3","5":"1","_rn_":"159"},{"1":"R.steindachneri","2":"16.53665","3":"-16.471118","4":"3","5":"1","_rn_":"160"},{"1":"R.steindachneri","2":"16.49766","3":"-16.073154","4":"3","5":"1","_rn_":"161"},{"1":"R.steindachneri","2":"16.57975","3":"-16.656891","4":"3","5":"1","_rn_":"162"},{"1":"R.steindachneri","2":"15.32919","3":"-15.662595","4":"3","5":"1","_rn_":"163"},{"1":"R.steindachneri","2":"16.14662","3":"-17.340979","4":"3","5":"1","_rn_":"164"},{"1":"R.steindachneri","2":"16.01493","3":"-16.247608","4":"3","5":"1","_rn_":"165"},{"1":"R.steindachneri","2":"16.46296","3":"-16.141591","4":"3","5":"1","_rn_":"166"},{"1":"R.steindachneri","2":"15.77952","3":"-16.404043","4":"3","5":"1","_rn_":"167"},{"1":"R.steindachneri","2":"16.27200","3":"-16.349594","4":"3","5":"1","_rn_":"168"},{"1":"R.steindachneri","2":"16.46201","3":"-16.509605","4":"3","5":"1","_rn_":"169"},{"1":"R.steindachneri","2":"17.32705","3":"-17.275792","4":"3","5":"1","_rn_":"170"},{"1":"R.steindachneri","2":"16.35364","3":"-16.552466","4":"3","5":"1","_rn_":"171"},{"1":"R.steindachneri","2":"16.38287","3":"-18.287220","4":"3","5":"1","_rn_":"172"},{"1":"R.steindachneri","2":"16.23135","3":"-16.347020","4":"3","5":"1","_rn_":"173"},{"1":"R.steindachneri","2":"16.09177","3":"-16.493859","4":"3","5":"1","_rn_":"174"},{"1":"R.steindachneri","2":"15.72443","3":"-16.560041","4":"3","5":"1","_rn_":"175"},{"1":"R.steindachneri","2":"16.91540","3":"-16.193612","4":"3","5":"1","_rn_":"176"},{"1":"R.steindachneri","2":"16.42032","3":"-16.805064","4":"3","5":"1","_rn_":"177"},{"1":"R.steindachneri","2":"15.54379","3":"-15.992761","4":"3","5":"1","_rn_":"178"},{"1":"R.steindachneri","2":"16.69808","3":"-16.435780","4":"3","5":"1","_rn_":"179"},{"1":"R.steindachneri","2":"16.24376","3":"-16.415844","4":"3","5":"1","_rn_":"180"},{"1":"R.steindachneri","2":"16.49527","3":"-16.143587","4":"3","5":"1","_rn_":"181"},{"1":"R.steindachneri","2":"16.74911","3":"-16.390769","4":"3","5":"1","_rn_":"182"},{"1":"R.steindachneri","2":"16.53265","3":"-16.048045","4":"3","5":"1","_rn_":"183"},{"1":"R.steindachneri","2":"16.08637","3":"-15.879976","4":"3","5":"1","_rn_":"184"},{"1":"R.steindachneri","2":"16.86799","3":"-16.451641","4":"3","5":"1","_rn_":"185"},{"1":"R.steindachneri","2":"15.33345","3":"-15.953029","4":"3","5":"1","_rn_":"186"},{"1":"R.steindachneri","2":"16.61367","3":"-16.192232","4":"3","5":"1","_rn_":"187"},{"1":"R.steindachneri","2":"16.25680","3":"-16.465277","4":"3","5":"1","_rn_":"188"},{"1":"R.steindachneri","2":"16.35283","3":"-16.847520","4":"3","5":"1","_rn_":"189"},{"1":"R.steindachneri","2":"16.54029","3":"-16.484754","4":"3","5":"1","_rn_":"190"},{"1":"R.steindachneri","2":"16.54030","3":"-16.548040","4":"3","5":"1","_rn_":"191"},{"1":"R.steindachneri","2":"16.30900","3":"-16.998638","4":"3","5":"1","_rn_":"192"},{"1":"R.steindachneri","2":"13.64931","3":"-15.188579","4":"3","5":"1","_rn_":"193"},{"1":"R.steindachneri","2":"16.56865","3":"-16.443113","4":"3","5":"1","_rn_":"194"},{"1":"R.steindachneri","2":"16.16462","3":"-16.480419","4":"3","5":"1","_rn_":"195"},{"1":"R.steindachneri","2":"16.62797","3":"-16.087582","4":"3","5":"1","_rn_":"196"},{"1":"R.steindachneri","2":"15.53679","3":"-16.389839","4":"3","5":"1","_rn_":"197"},{"1":"R.steindachneri","2":"16.05954","3":"-15.992941","4":"3","5":"1","_rn_":"198"},{"1":"R.steindachneri","2":"16.19519","3":"-15.131091","4":"3","5":"1","_rn_":"199"},{"1":"R.steindachneri","2":"14.62773","3":"-14.953427","4":"3","5":"1","_rn_":"200"},{"1":"R.steindachneri","2":"16.38464","3":"-16.104175","4":"3","5":"1","_rn_":"201"},{"1":"R.steindachneri","2":"14.49365","3":"-15.006439","4":"3","5":"1","_rn_":"202"},{"1":"R.steindachneri","2":"15.52546","3":"-15.207912","4":"3","5":"1","_rn_":"203"},{"1":"R.steindachneri","2":"15.86696","3":"-15.335525","4":"3","5":"1","_rn_":"204"},{"1":"R.steindachneri","2":"16.06657","3":"-15.754995","4":"3","5":"1","_rn_":"205"},{"1":"R.steindachneri","2":"15.25191","3":"-14.981017","4":"3","5":"1","_rn_":"206"},{"1":"R.steindachneri","2":"15.39489","3":"-14.299293","4":"3","5":"1","_rn_":"207"},{"1":"R.steindachneri","2":"17.03698","3":"-15.565706","4":"3","5":"1","_rn_":"208"},{"1":"R.steindachneri","2":"15.99375","3":"-15.466643","4":"3","5":"1","_rn_":"209"},{"1":"R.steindachneri","2":"16.06457","3":"-15.345925","4":"3","5":"1","_rn_":"210"},{"1":"R.steindachneri","2":"15.22550","3":"-15.023894","4":"3","5":"1","_rn_":"211"},{"1":"R.steindachneri","2":"16.64774","3":"-16.469854","4":"3","5":"1","_rn_":"212"},{"1":"R.steindachneri","2":"16.62089","3":"-16.104047","4":"3","5":"1","_rn_":"213"},{"1":"R.steindachneri","2":"16.26895","3":"-16.276613","4":"3","5":"1","_rn_":"214"},{"1":"R.steindachneri","2":"13.75479","3":"-13.760419","4":"3","5":"1","_rn_":"215"},{"1":"R.steindachneri","2":"15.81578","3":"-14.870542","4":"3","5":"1","_rn_":"216"},{"1":"R.steindachneri","2":"14.37257","3":"-13.078980","4":"3","5":"1","_rn_":"217"},{"1":"R.steindachneri","2":"13.86937","3":"-12.943184","4":"3","5":"1","_rn_":"218"},{"1":"R.steindachneri","2":"14.49742","3":"-13.262263","4":"3","5":"1","_rn_":"219"},{"1":"R.steindachneri","2":"13.54230","3":"-13.348382","4":"3","5":"1","_rn_":"220"},{"1":"R.steindachneri","2":"16.20455","3":"-15.987939","4":"3","5":"1","_rn_":"221"},{"1":"R.steindachneri","2":"16.53866","3":"-17.063799","4":"3","5":"1","_rn_":"222"},{"1":"R.steindachneri","2":"17.19502","3":"-16.609368","4":"3","5":"1","_rn_":"223"},{"1":"R.steindachneri","2":"16.32322","3":"-14.537800","4":"3","5":"1","_rn_":"224"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="basic-plot" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="basic-plot"><span class="header-section-number">3.3.2</span> Basic plot</h3>
<p>Parameters and basic information</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>global_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#1f77b4'</span>, <span class="st">'#ff7f0e'</span>, <span class="st">'#2ca02c'</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>xlims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(global<span class="sc">$</span>iso2)<span class="sc">-</span><span class="fl">0.5</span>, <span class="fu">max</span>(global<span class="sc">$</span>iso2)<span class="sc">+</span><span class="fl">0.5</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>ylims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(global<span class="sc">$</span>iso1)<span class="sc">-</span><span class="fl">0.5</span>, <span class="fu">max</span>(global<span class="sc">$</span>iso1)<span class="sc">+</span><span class="fl">0.5</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> <span class="fu">unique</span>(global<span class="sc">$</span>sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>glob_ellipses <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> global, <span class="fu">aes</span>(<span class="at">x =</span> iso2, <span class="at">y =</span> iso1, <span class="at">color =</span> <span class="fu">as.factor</span>(group))) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">stat_ellipse</span>(<span class="at">level =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">geom_convexhull</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">scale_color_manual</span>(<span class="at">values =</span> global_colors, <span class="at">name =</span> <span class="st">"Species"</span>, <span class="at">labels =</span> species) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> xlims, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">18</span>, <span class="sc">-</span><span class="dv">8</span>, <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> ylims, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">x =</span> <span class="fu">expression</span>({delta}<span class="sc">^</span><span class="dv">13</span><span class="sc">*</span>C<span class="sc">~</span><span class="st">'(\u2030)'</span>),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">y =</span> <span class="fu">expression</span>({delta}<span class="sc">^</span><span class="dv">15</span><span class="sc">*</span>N<span class="sc">~</span><span class="st">'(\u2030)'</span>)) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.18</span>, <span class="fl">0.15</span>),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.background =</span> <span class="fu">element_blank</span>())</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># cairo_pdf("output/SIBER/global/global_ellipses.pdf",</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#           family = "Times", height = 4, width = 4)</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>glob_ellipses</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ES3_SIBER_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fitting-the-bayesian-bi-variate-normal-models" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="fitting-the-bayesian-bi-variate-normal-models"><span class="header-section-number">3.3.3</span> Fitting the Bayesian Bi-variate Normal models:</h3>
<p>Creation of the SIBER object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>siber_glob <span class="ot">&lt;-</span> <span class="fu">createSiberObject</span>(global[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Parameters of the MCMC:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>parms<span class="sc">$</span>n.iter   <span class="ot">&lt;-</span> <span class="dv">2000</span>    </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>parms<span class="sc">$</span>n.burnin <span class="ot">&lt;-</span> <span class="dv">25000</span>   </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>parms<span class="sc">$</span>n.thin   <span class="ot">&lt;-</span> <span class="dv">1</span>          </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>parms<span class="sc">$</span>n.chains <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>parms<span class="sc">$</span>save.output <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>parms<span class="sc">$</span>save.dir <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">getwd</span>(),<span class="st">"/output/SIBER/global"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Prior distributions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>priors<span class="sc">$</span>R <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">*</span> <span class="fu">diag</span>(<span class="dv">2</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>priors<span class="sc">$</span>k <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>priors<span class="sc">$</span>tau.mu <span class="ot">&lt;-</span> <span class="fl">1.0E-3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sampling of the posterior distributions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ellipses.posterior <span class="ot">&lt;-</span> <span class="fu">siberMVN</span>(siber_glob, parms, priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 81
   Unobserved stochastic nodes: 3
   Total graph size: 96

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 69
   Unobserved stochastic nodes: 3
   Total graph size: 84

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 74
   Unobserved stochastic nodes: 3
   Total graph size: 89

Initializing model</code></pre>
</div>
</div>
<section id="diagnostics" class="level4" data-number="3.3.3.1">
<h4 data-number="3.3.3.1" class="anchored" data-anchor-id="diagnostics"><span class="header-section-number">3.3.3.1</span> Diagnostics:</h4>
<p>Cycling through every model to extract information:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>all_files <span class="ot">&lt;-</span> <span class="fu">dir</span>(parms<span class="sc">$</span>save.dir, <span class="at">full.names =</span> T)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>model_files <span class="ot">&lt;-</span> all_files[<span class="fu">grep</span>(<span class="st">"jags_output"</span>, all_files)]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>model_summary <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(model_files)) {</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">load</span>(model_files[i])</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  mcmc_list <span class="ot">&lt;-</span> coda<span class="sc">::</span><span class="fu">as.mcmc</span>(<span class="fu">do.call</span>(<span class="st">"cbind"</span>, output))</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  model_summary[[i]] <span class="ot">&lt;-</span> <span class="fu">MCMCsummary</span>(output,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">params =</span> <span class="st">"all"</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>),</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">round =</span> <span class="dv">3</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MCMCtrace</span>(output,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">params =</span> <span class="st">"all"</span>,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">iter =</span> parms<span class="sc">$</span>n.iter,</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">Rhat =</span> T,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">n.eff =</span> T,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">ind =</span> T,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">"density"</span>,</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">open_pdf =</span> F,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">filename =</span> <span class="fu">sprintf</span>(<span class="st">"output/SIBER/global/MCMCtrace_%d"</span>, i))</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Autocorrelation plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cairo_pdf("output/SIBER/global_autocorr.pdf",</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#           family = "Times", height = 10, width = 12)</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(<span class="fu">mcmc_acf</span>(ellipses.posterior[<span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> species[<span class="dv">1</span>]),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">mcmc_acf</span>(ellipses.posterior[<span class="dv">2</span>]) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> species[<span class="dv">2</span>]),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">mcmc_acf</span>(ellipses.posterior[<span class="dv">3</span>]) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> species[<span class="dv">3</span>]),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ES3_SIBER_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>null device 
          1 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(<span class="fu">mcmc_acf</span>(ellipses.posterior[<span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> species[<span class="dv">1</span>]),</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">mcmc_acf</span>(ellipses.posterior[<span class="dv">2</span>]) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> species[<span class="dv">2</span>]),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">mcmc_acf</span>(ellipses.posterior[<span class="dv">3</span>]) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> species[<span class="dv">3</span>]),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ES3_SIBER_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>Summaries. Gelman-Rubick Statistics (Rhat) exactly equal to 1 and effective sample sizes &gt; 2000 for every parameter:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(model_files)) {</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">load</span>(model_files[i])</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(species[i])</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(model_summary[[i]])</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "H.dipterurus"
              mean    sd   2.5%  97.5% Rhat n.eff
Sigma2[1,1]  1.029 0.164  0.757  1.393    1  6000
Sigma2[2,1] -0.560 0.133 -0.853 -0.336    1  6000
Sigma2[1,2] -0.560 0.133 -0.853 -0.336    1  6000
Sigma2[2,2]  1.028 0.166  0.752  1.397    1  5797
mu[1]        0.001 0.111 -0.221  0.219    1  3107
mu[2]       -0.001 0.112 -0.218  0.221    1  3112
[1] "N.entemedor"
              mean    sd   2.5%  97.5% Rhat n.eff
Sigma2[1,1]  1.026 0.177  0.737  1.422    1  6000
Sigma2[2,1] -0.681 0.152 -1.023 -0.426    1  6000
Sigma2[1,2] -0.681 0.152 -1.023 -0.426    1  6000
Sigma2[2,2]  1.029 0.180  0.732  1.438    1  5872
mu[1]        0.004 0.122 -0.236  0.244    1  2238
mu[2]       -0.005 0.122 -0.244  0.240    1  2333
[1] "R.steindachneri"
              mean    sd   2.5%  97.5% Rhat n.eff
Sigma2[1,1]  1.024 0.175  0.740  1.422 1.00  6000
Sigma2[2,1] -0.770 0.155 -1.129 -0.519 1.00  6190
Sigma2[1,2] -0.770 0.155 -1.129 -0.519 1.00  6190
Sigma2[2,2]  1.026 0.176  0.742  1.430 1.00  6257
mu[1]        0.000 0.118 -0.231  0.229 1.01  1659
mu[2]        0.000 0.118 -0.228  0.230 1.01  1731</code></pre>
</div>
</div>
</section>
<section id="inferences" class="level4" data-number="3.3.3.2">
<h4 data-number="3.3.3.2" class="anchored" data-anchor-id="inferences"><span class="header-section-number">3.3.3.2</span> Inferences</h4>
<p>Generation of the ellipses:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>sea_b <span class="ot">&lt;-</span> <span class="fu">siberEllipses</span>(ellipses.posterior)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sea_b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       V1               V2              V3       
 Min.   : 6.528   Min.   :1.400   Min.   :1.128  
 1st Qu.: 8.904   1st Qu.:1.964   1st Qu.:1.538  
 Median : 9.564   Median :2.138   Median :1.659  
 Mean   : 9.652   Mean   :2.153   Mean   :1.677  
 3rd Qu.:10.325   3rd Qu.:2.321   3rd Qu.:1.799  
 Max.   :15.348   Max.   :3.519   Max.   :2.776  </code></pre>
</div>
</div>
<p>Graphical comparisons. First, transform the object to a data.frame and melt it to long format:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>sea_bt <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(<span class="fu">as.data.frame</span>(sea_b))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No id variables; using all as measure variables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sea_bt) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sp"</span>, <span class="st">"SEAb"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sea_bt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["sp"],"name":[1],"type":["fct"],"align":["left"]},{"label":["SEAb"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"V1","2":"8.393081","_rn_":"1"},{"1":"V1","2":"9.912005","_rn_":"2"},{"1":"V1","2":"11.168641","_rn_":"3"},{"1":"V1","2":"11.640891","_rn_":"4"},{"1":"V1","2":"10.711972","_rn_":"5"},{"1":"V1","2":"10.767556","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Get the HDI for each species:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>hdi <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">apply</span>(sea_b, <span class="dv">2</span>, <span class="at">FUN =</span> HDInterval<span class="sc">::</span>hdi)))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>hdi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(hdi, <span class="at">means =</span> <span class="fu">t</span>(<span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">apply</span>(sea_b, <span class="dv">2</span>, <span class="at">FUN =</span> mean)))))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>hdi[<span class="st">"sp"</span>] <span class="ot">&lt;-</span> <span class="fu">row.names</span>(hdi)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>hdi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["lower"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["upper"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["means"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sp"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"7.772807","2":"11.964066","3":"9.652099","4":"V1","_rn_":"V1"},{"1":"1.689580","2":"2.696786","3":"2.152599","4":"V2","_rn_":"V2"},{"1":"1.301107","2":"2.081367","3":"1.677158","4":"V3","_rn_":"V3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Violin plot with the posterior distributions of the SEAb:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>seab_global <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">geom_violin</span>(<span class="at">data =</span> sea_bt, <span class="fu">aes</span>(<span class="at">x =</span> sp, <span class="at">y =</span> SEAb, <span class="at">fill =</span> sp, <span class="at">color =</span> sp),</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">show.legend =</span> F, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">geom_boxplot</span>(<span class="at">data =</span> sea_bt,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">aes</span>(<span class="at">x =</span> sp, <span class="at">y =</span> SEAb, <span class="at">fill =</span> sp, <span class="at">color =</span> sp),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.05</span>, <span class="at">notch =</span> T, <span class="at">show.legend =</span> F,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">coef =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> global_colors) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">scale_color_manual</span>(<span class="at">values =</span> global_colors) <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">geom_linerange</span>(<span class="at">data =</span> hdi,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">aes</span>(<span class="at">x =</span> sp, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper, <span class="at">color =</span> sp),</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>               <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>               <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.15</span>),</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>               <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Species"</span>,</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> <span class="fu">expression</span>(<span class="st">"SEAb "</span> (<span class="st">'\u2030'</span> <span class="sc">^</span><span class="dv">2</span>) )) <span class="sc">+</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>               <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> species)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="co"># cairo_pdf("output/SIBER/global/global_seab.pdf",</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="co">#           family = "Times", height = 5, width = 5)</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>seab_global</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ES3_SIBER_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Posterior Differences:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the comparisons</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>comps <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">a =</span> <span class="fu">unique</span>(<span class="fu">as.integer</span>(global<span class="sc">$</span>group)),</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">b =</span> <span class="fu">unique</span>(<span class="fu">as.integer</span>(global<span class="sc">$</span>group)))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>comps <span class="ot">&lt;-</span> comps[(comps<span class="sc">$</span>a <span class="sc">!=</span> comps<span class="sc">$</span>b <span class="sc">&amp;</span> comps<span class="sc">$</span>b <span class="sc">&gt;</span> comps<span class="sc">$</span>a), ]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>comps <span class="ot">&lt;-</span> comps[<span class="fu">order</span>(comps<span class="sc">$</span>a),]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Put the results in different objects:</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>diffs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>diff_glob <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>p_sup <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(comps<span class="sc">$</span>a)) {</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> comps<span class="sc">$</span>a[i]</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> comps<span class="sc">$</span>b[i]</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  comp <span class="ot">&lt;-</span> <span class="fu">paste</span>(species[a], <span class="st">"-"</span>, species[b])</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  diff <span class="ot">&lt;-</span> sea_b[, a] <span class="sc">-</span> sea_b[, b]</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  sup <span class="ot">&lt;-</span> <span class="fu">subset</span>(diff, diff<span class="sc">&gt;</span><span class="dv">0</span>, <span class="at">select =</span> diff)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  diffs <span class="ot">&lt;-</span> <span class="fu">rbind</span>(diffs,</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">data.frame</span>(<span class="at">comp =</span> comp,</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>                            <span class="at">diff =</span> diff))</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  diff_glob <span class="ot">&lt;-</span> <span class="fu">rbind</span>(diff_glob,</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">data.frame</span>(<span class="at">comp =</span> comp,</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>                                <span class="at">mean =</span> <span class="fu">mean</span>(diff),</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>                                <span class="at">IQr =</span> <span class="fu">t</span>(HDInterval<span class="sc">::</span><span class="fu">hdi</span>(diff, <span class="at">credMass =</span> <span class="fl">0.5</span>)),</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>                                <span class="at">hdi =</span> <span class="fu">t</span>(HDInterval<span class="sc">::</span><span class="fu">hdi</span>(diff, <span class="at">credMass =</span> <span class="fl">0.95</span>))</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  p_sup <span class="ot">&lt;-</span> <span class="fu">rbind</span>(p_sup,</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">data.frame</span>(<span class="at">comp =</span> comp,</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>                            <span class="at">p_sup =</span> (<span class="fu">length</span>(sup)<span class="sc">/</span><span class="fu">length</span>(diff))<span class="sc">*</span><span class="dv">100</span>))</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>diff_glob<span class="sc">$</span>comp <span class="ot">&lt;-</span> <span class="fu">factor</span>(diff_glob<span class="sc">$</span>comp, <span class="at">ordered =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>HDIs of differences</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>diff_glob</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["comp"],"name":[1],"type":["ord"],"align":["right"]},{"label":["mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["IQr.lower"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["IQr.upper"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["hdi.lower"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["hdi.upper"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"H.dipterurus - N.entemedor","2":"7.4994998","3":"6.4612280","4":"7.9252962","5":"5.4165777","6":"9.804244"},{"1":"H.dipterurus - R.steindachneri","2":"7.9749408","3":"7.1038758","4":"8.5207872","5":"5.8398524","6":"10.121132"},{"1":"N.entemedor - R.steindachneri","2":"0.4754409","3":"0.2464864","4":"0.6889092","5":"-0.1696643","6":"1.122658"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Probabilities of differences:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>p_sup</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["comp"],"name":[1],"type":["chr"],"align":["left"]},{"label":["p_sup"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"H.dipterurus - N.entemedor","2":"100.00000"},{"1":"H.dipterurus - R.steindachneri","2":"100.00000"},{"1":"N.entemedor - R.steindachneri","2":"92.78333"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Forestplot of the <span class="math inline">\(HDI_{95\%}\)</span> of the differences</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>global_forest <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> diff_glob) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#C9C8C8"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">y =</span> comp, <span class="at">xmin =</span> IQr.lower, <span class="at">xmax =</span> IQr.upper),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">color =</span> global_colors[<span class="dv">1</span>], <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">y =</span> comp, <span class="at">xmin =</span> hdi.lower, <span class="at">xmax =</span> hdi.upper),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                                <span class="at">color =</span> global_colors[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean, <span class="at">y =</span> comp), <span class="at">color =</span> global_colors[<span class="dv">1</span>], <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.15</span>),</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>                      <span class="at">y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cairo_pdf("output/SIBER/global/global_forest.pdf",</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">#           family = "Times", height = 4, width = 4)</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>global_forest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ES3_SIBER_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="eccentricity-and-theta" class="level4" data-number="3.3.3.3">
<h4 data-number="3.3.3.3" class="anchored" data-anchor-id="eccentricity-and-theta"><span class="header-section-number">3.3.3.3</span> Eccentricity and theta</h4>
<p>Eccentricities represent the elongation of the ellipse, that is, how far they are from a perfect circle (0 eccentricity). Lower values indicate a rounder ellipse, while higher values indicate a more elongated ellipse.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>mat_ecc <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(x, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  ecc <span class="ot">&lt;-</span> <span class="fu">sigmaSEA</span>(mat)<span class="sc">$</span>ecc</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ecc)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>mat_theta <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(x, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> <span class="fu">sigmaSEA</span>(mat)<span class="sc">$</span>theta</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(theta)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>ecc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (sp <span class="cf">in</span> <span class="fu">seq_along</span>(ellipses.posterior)) {</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  ecc <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ecc,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>               <span class="fu">data.frame</span>(<span class="at">sp =</span> species[sp],</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ecc =</span> <span class="fu">apply</span>(ellipses.posterior[[sp]][,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">1</span>, mat_ecc),</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">theta =</span> <span class="fu">apply</span>(ellipses.posterior[[sp]][,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">1</span>, mat_theta)))</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>ec <span class="ot">&lt;-</span> ecc <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sp) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">IQR.lower =</span> <span class="fu">hdi</span>(ecc, <span class="at">credMass =</span> <span class="fl">0.5</span>)[<span class="dv">1</span>],</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">IQR.upper =</span> <span class="fu">hdi</span>(ecc, <span class="at">credMass =</span> <span class="fl">0.5</span>)[<span class="dv">2</span>],</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">hdi.lower =</span> <span class="fu">hdi</span>(ecc)[<span class="dv">1</span>],</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">hdi.upper =</span> <span class="fu">hdi</span>(ecc)[<span class="dv">2</span>],</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">mean =</span> <span class="fu">mean</span>(ecc))</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>ec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sp"],"name":[1],"type":["chr"],"align":["left"]},{"label":["IQR.lower"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["IQR.upper"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["hdi.lower"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["hdi.upper"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"H.dipterurus","2":"0.8404042","3":"0.8859573","4":"0.7698741","5":"0.9160364","6":"0.8466032"},{"1":"N.entemedor","2":"0.9009847","3":"0.9303611","4":"0.8576872","5":"0.9489378","6":"0.9066400"},{"1":"R.steindachneri","2":"0.9194025","3":"0.9411587","4":"0.8955510","5":"0.9605052","6":"0.9286437"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ecc, <span class="fu">aes</span>(<span class="at">x =</span> sp, <span class="at">y =</span> ecc, <span class="at">group =</span> sp, <span class="at">color =</span> <span class="fu">factor</span>(sp))) <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> sp, <span class="at">y =</span> mean), <span class="at">data =</span> ec, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_errorbar(aes(x = sp, ymin = IQ.lower, ymax = IQ.upper, group = sp), data = ag) +</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SEAB Eccentricity"</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> global_colors) <span class="sc">+</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.1</span>),</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.background =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ES3_SIBER_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Theta, on the other hand, is the angle of the semi-major axis of the SEA and the x axis; <em>i.e.</em>, the angle of the deformation. Values close to 0 show a higher dispersion in <span class="math inline">\(\delta^{13}C\)</span>, while values close to 90 show a higher dispersion in <span class="math inline">\(\delta^{15}N\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>th <span class="ot">&lt;-</span> ecc <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sp) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">IQR.lower =</span> <span class="fu">hdi</span>(theta, <span class="at">credMass =</span> <span class="fl">0.5</span>)[<span class="dv">1</span>],</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">IQR.upper =</span> <span class="fu">hdi</span>(theta, <span class="at">credMass =</span> <span class="fl">0.5</span>)[<span class="dv">2</span>],</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">hdi.lower =</span> <span class="fu">hdi</span>(theta)[<span class="dv">1</span>],</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">hdi.upper =</span> <span class="fu">hdi</span>(theta)[<span class="dv">2</span>],</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">mean =</span> <span class="fu">mean</span>(theta))</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sp"],"name":[1],"type":["chr"],"align":["left"]},{"label":["IQR.lower"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["IQR.upper"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["hdi.lower"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["hdi.upper"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"H.dipterurus","2":"-0.9766505","3":"-0.8691764","4":"-1.0952082","5":"-0.7621627","6":"-0.9295179"},{"1":"N.entemedor","2":"-1.0454748","3":"-0.9656876","4":"-1.1351088","5":"-0.8921902","6":"-1.0087092"},{"1":"R.steindachneri","2":"-0.9418155","3":"-0.8748783","4":"-0.9990304","5":"-0.8036233","6":"-0.9036154"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ecc, <span class="fu">aes</span>(<span class="at">x =</span> sp, <span class="at">y =</span> theta, <span class="at">group =</span> sp, <span class="at">color =</span> <span class="fu">factor</span>(sp))) <span class="sc">+</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> sp, <span class="at">y =</span> mean), <span class="at">data =</span> ec, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_errorbar(aes(x = sp, ymin = IQ.lower, ymax = IQ.upper, group = sp), data = ag) +</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SEAB theta"</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> global_colors) <span class="sc">+</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.1</span>),</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.background =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ES3_SIBER_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="intra-specific-analyses" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="intra-specific-analyses"><span class="header-section-number">3.4</span> Intra-specific analyses</h2>
<p>Basic dataset to extract every case:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>full_set <span class="ot">&lt;-</span> <span class="fu">subset</span>(data,</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">select =</span> <span class="fu">c</span>(sp, temporada, sexo, estadio, iso1, iso2))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(full_set)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["sp"],"name":[1],"type":["chr"],"align":["left"]},{"label":["temporada"],"name":[2],"type":["chr"],"align":["left"]},{"label":["sexo"],"name":[3],"type":["chr"],"align":["left"]},{"label":["estadio"],"name":[4],"type":["chr"],"align":["left"]},{"label":["iso1"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["iso2"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"H.dipterurus","2":"Calida","3":"M","4":"Juvenil","5":"16.30122","6":"-14.50678","_rn_":"1"},{"1":"H.dipterurus","2":"Calida","3":"H","4":"Juvenil","5":"16.83237","6":"-17.81040","_rn_":"2"},{"1":"H.dipterurus","2":"Calida","3":"M","4":"Adulto","5":"17.13546","6":"-15.83143","_rn_":"3"},{"1":"H.dipterurus","2":"Calida","3":"H","4":"Juvenil","5":"13.12309","6":"-15.96596","_rn_":"4"},{"1":"H.dipterurus","2":"Calida","3":"M","4":"Adulto","5":"17.63312","6":"-16.71944","_rn_":"5"},{"1":"H.dipterurus","2":"Calida","3":"H","4":"Juvenil","5":"17.59479","6":"-16.89169","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<section id="custom-wrapper-around-siber" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="custom-wrapper-around-siber"><span class="header-section-number">3.4.1</span> Custom wrapper around SIBER:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>custom_siber <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var_col, lbls, sp_col, colors, gp_label,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">n.burnin =</span> <span class="dv">30000</span>, <span class="at">n.iter =</span> <span class="dv">2000</span>){</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  subdata <span class="ot">&lt;-</span> data[,<span class="fu">c</span>(sp_col, var_col, <span class="st">"iso1"</span>, <span class="st">"iso2"</span>)]</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  subdata<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(subdata[,var_col], <span class="at">labels =</span> <span class="fu">seq_along</span>(lbls))</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  subdata<span class="sc">$</span>community <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  species <span class="ot">&lt;-</span> <span class="fu">unique</span>(data[, sp_col])</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Global directory for the variable</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  wd <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">getwd</span>(), <span class="st">"/output/SIBER/"</span>, var_col, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If the directory does not exist, create it:</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">dir.exists</span>(wd) <span class="sc">==</span> F) {<span class="fu">dir.create</span>(wd)}</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Empty lists to store the results:</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  siber_objs <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  ellipses <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  summaries <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  autocorr_plots <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  sea_b <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  sea_bt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  hdis <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>  ecc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Posterior differences</span></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the comparisons</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>  comps <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">a =</span> <span class="fu">unique</span>(<span class="fu">as.integer</span>(subdata<span class="sc">$</span>group)),</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>                       <span class="at">b =</span> <span class="fu">unique</span>(<span class="fu">as.integer</span>(subdata<span class="sc">$</span>group)))</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>  comps <span class="ot">&lt;-</span> comps[(comps<span class="sc">$</span>a <span class="sc">!=</span> comps<span class="sc">$</span>b <span class="sc">&amp;</span> comps<span class="sc">$</span>b <span class="sc">&gt;</span> comps<span class="sc">$</span>a), ]</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>  comps <span class="ot">&lt;-</span> comps[<span class="fu">order</span>(comps<span class="sc">$</span>a),]</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Put the results in different objects:</span></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>  diffs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>  diff_glob <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>  p_sup <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># List with MCMC parameters:</span></span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>  parms <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>    parms <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>    parms<span class="sc">$</span>n.iter   <span class="ot">&lt;-</span> n.iter    </span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>    parms<span class="sc">$</span>n.burnin <span class="ot">&lt;-</span> n.burnin   </span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>    parms<span class="sc">$</span>n.thin   <span class="ot">&lt;-</span> <span class="dv">1</span>          </span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>    parms<span class="sc">$</span>n.chains <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>    parms<span class="sc">$</span>save.output <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># List with prior parameters:</span></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>  priors <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>    priors<span class="sc">$</span>R <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">*</span> <span class="fu">diag</span>(<span class="dv">2</span>)</span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>    priors<span class="sc">$</span>k <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>    priors<span class="sc">$</span>tau.mu <span class="ot">&lt;-</span> <span class="fl">1.0E-3</span></span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Basic ellipses plot</span></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a>  ellipses <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> subdata, <span class="fu">aes</span>(<span class="at">x =</span> iso2, <span class="at">y =</span> iso1, <span class="at">color =</span> <span class="fu">as.factor</span>(group))) <span class="sc">+</span></span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">stat_ellipse</span>(<span class="at">level =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">geom_convexhull</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">scale_color_manual</span>(<span class="at">values =</span> global_colors, <span class="at">name =</span> gp_label, <span class="at">labels =</span> lbls) <span class="sc">+</span></span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> xlims, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">18</span>, <span class="sc">-</span><span class="dv">8</span>, <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> ylims, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="fu">expression</span>({delta}<span class="sc">^</span><span class="dv">13</span><span class="sc">*</span>C<span class="sc">~</span><span class="st">'(\u2030)'</span>),</span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="fu">expression</span>({delta}<span class="sc">^</span><span class="dv">15</span><span class="sc">*</span>N<span class="sc">~</span><span class="st">'(\u2030)'</span>)) <span class="sc">+</span></span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a>                           <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a>                           <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a>                           <span class="co">#legend.position = c(0.2, 0.15),</span></span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a>                           <span class="at">legend.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">facet_wrap</span>(<span class="fu">paste</span>(<span class="st">"~"</span>, sp_col, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cairo_pdf</span>(<span class="fu">paste</span>(wd, <span class="st">"ellipses.pdf"</span>, <span class="at">sep =</span> <span class="st">"/"</span>), <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">width =</span> <span class="dv">8</span>)</span>
<span id="cb40-77"><a href="#cb40-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(ellipses)</span>
<span id="cb40-78"><a href="#cb40-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dev.off</span>()</span>
<span id="cb40-79"><a href="#cb40-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-80"><a href="#cb40-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop through species:</span></span>
<span id="cb40-81"><a href="#cb40-81" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(species)) {</span>
<span id="cb40-82"><a href="#cb40-82" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb40-83"><a href="#cb40-83" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Output directory:</span></span>
<span id="cb40-84"><a href="#cb40-84" aria-hidden="true" tabindex="-1"></a>      gpwd <span class="ot">&lt;-</span> <span class="fu">paste</span>(wd, <span class="st">"/"</span>, species[i], <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb40-85"><a href="#cb40-85" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">dir.exists</span>(gpwd) <span class="sc">==</span> F) {<span class="fu">dir.create</span>(gpwd)}</span>
<span id="cb40-86"><a href="#cb40-86" aria-hidden="true" tabindex="-1"></a>      parms<span class="sc">$</span>save.dir <span class="ot">&lt;-</span> gpwd</span>
<span id="cb40-87"><a href="#cb40-87" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb40-88"><a href="#cb40-88" aria-hidden="true" tabindex="-1"></a>      <span class="co"># SIBER objects</span></span>
<span id="cb40-89"><a href="#cb40-89" aria-hidden="true" tabindex="-1"></a>      siber_objs[[species[i]]] <span class="ot">&lt;-</span> <span class="fu">createSiberObject</span>(subdata[subdata[, sp_col] <span class="sc">==</span> species[i],<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb40-90"><a href="#cb40-90" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb40-91"><a href="#cb40-91" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Fitting the Bayesian models:</span></span>
<span id="cb40-92"><a href="#cb40-92" aria-hidden="true" tabindex="-1"></a>      ellipses[[species[i]]] <span class="ot">&lt;-</span> <span class="fu">siberMVN</span>(siber_objs[[i]], parms, priors)</span>
<span id="cb40-93"><a href="#cb40-93" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb40-94"><a href="#cb40-94" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Diagnostics</span></span>
<span id="cb40-95"><a href="#cb40-95" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Get all the files in the directory</span></span>
<span id="cb40-96"><a href="#cb40-96" aria-hidden="true" tabindex="-1"></a>      all_files <span class="ot">&lt;-</span> <span class="fu">dir</span>(parms<span class="sc">$</span>save.dir, <span class="at">full.names =</span> T)</span>
<span id="cb40-97"><a href="#cb40-97" aria-hidden="true" tabindex="-1"></a>      model_files <span class="ot">&lt;-</span> all_files[<span class="fu">grep</span>(<span class="st">"jags_output"</span>, all_files)]</span>
<span id="cb40-98"><a href="#cb40-98" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb40-99"><a href="#cb40-99" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Empty lists to store the results</span></span>
<span id="cb40-100"><a href="#cb40-100" aria-hidden="true" tabindex="-1"></a>      summaries[[species[i]]] <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb40-101"><a href="#cb40-101" aria-hidden="true" tabindex="-1"></a>      autocorr_plots[[species[i]]] <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb40-102"><a href="#cb40-102" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb40-103"><a href="#cb40-103" aria-hidden="true" tabindex="-1"></a>      <span class="co"># For each model:</span></span>
<span id="cb40-104"><a href="#cb40-104" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(model_files)) {</span>
<span id="cb40-105"><a href="#cb40-105" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Load the model output</span></span>
<span id="cb40-106"><a href="#cb40-106" aria-hidden="true" tabindex="-1"></a>        <span class="fu">load</span>(model_files[j])</span>
<span id="cb40-107"><a href="#cb40-107" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create a list with the output</span></span>
<span id="cb40-108"><a href="#cb40-108" aria-hidden="true" tabindex="-1"></a>        mcmc_list <span class="ot">&lt;-</span> coda<span class="sc">::</span><span class="fu">as.mcmc</span>(<span class="fu">do.call</span>(<span class="st">"cbind"</span>, output))</span>
<span id="cb40-109"><a href="#cb40-109" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-110"><a href="#cb40-110" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Store the summary for each model</span></span>
<span id="cb40-111"><a href="#cb40-111" aria-hidden="true" tabindex="-1"></a>        summaries[[species[i]]][[j]]<span class="ot">&lt;-</span> <span class="fu">MCMCsummary</span>(output,</span>
<span id="cb40-112"><a href="#cb40-112" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">params =</span> <span class="st">"all"</span>,</span>
<span id="cb40-113"><a href="#cb40-113" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>),</span>
<span id="cb40-114"><a href="#cb40-114" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">round =</span> <span class="dv">3</span>)</span>
<span id="cb40-115"><a href="#cb40-115" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Write the summary to a csv file</span></span>
<span id="cb40-116"><a href="#cb40-116" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write.csv</span>(summaries[[species[i]]][[j]],</span>
<span id="cb40-117"><a href="#cb40-117" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste</span>(gpwd, <span class="fu">sprintf</span>(<span class="st">"summary_%s.csv"</span>,</span>
<span id="cb40-118"><a href="#cb40-118" aria-hidden="true" tabindex="-1"></a>                                      lbls[j]), <span class="at">sep =</span> <span class="st">"/"</span>),</span>
<span id="cb40-119"><a href="#cb40-119" aria-hidden="true" tabindex="-1"></a>                  <span class="at">row.names =</span> T)</span>
<span id="cb40-120"><a href="#cb40-120" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-121"><a href="#cb40-121" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Plot the trace in a pdf</span></span>
<span id="cb40-122"><a href="#cb40-122" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MCMCtrace</span>(output,</span>
<span id="cb40-123"><a href="#cb40-123" aria-hidden="true" tabindex="-1"></a>                  <span class="at">params =</span> <span class="st">"all"</span>,</span>
<span id="cb40-124"><a href="#cb40-124" aria-hidden="true" tabindex="-1"></a>                  <span class="at">iter =</span> parms<span class="sc">$</span>n.iter,</span>
<span id="cb40-125"><a href="#cb40-125" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Rhat =</span> T,</span>
<span id="cb40-126"><a href="#cb40-126" aria-hidden="true" tabindex="-1"></a>                  <span class="at">n.eff =</span> T,</span>
<span id="cb40-127"><a href="#cb40-127" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ind =</span> T,</span>
<span id="cb40-128"><a href="#cb40-128" aria-hidden="true" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">"density"</span>,</span>
<span id="cb40-129"><a href="#cb40-129" aria-hidden="true" tabindex="-1"></a>                  <span class="at">open_pdf =</span> F,</span>
<span id="cb40-130"><a href="#cb40-130" aria-hidden="true" tabindex="-1"></a>                  <span class="co">#filename = paste(gpwd, sprintf("/MCMCtrace_%d", j), sep = ""))</span></span>
<span id="cb40-131"><a href="#cb40-131" aria-hidden="true" tabindex="-1"></a>                  <span class="at">filename =</span> <span class="fu">sprintf</span>(<span class="st">"MCMCtrace_%s"</span>, lbls[j]),</span>
<span id="cb40-132"><a href="#cb40-132" aria-hidden="true" tabindex="-1"></a>                  <span class="at">wd =</span> gpwd)</span>
<span id="cb40-133"><a href="#cb40-133" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-134"><a href="#cb40-134" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Store the autocorrelation plots</span></span>
<span id="cb40-135"><a href="#cb40-135" aria-hidden="true" tabindex="-1"></a>        autocorr_plots[[species[i]]][[j]] <span class="ot">&lt;-</span> <span class="fu">mcmc_acf</span>(ellipses[[species[i]]][j]) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> lbls[j])</span>
<span id="cb40-136"><a href="#cb40-136" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-137"><a href="#cb40-137" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-138"><a href="#cb40-138" aria-hidden="true" tabindex="-1"></a>      } <span class="co"># End of models loop</span></span>
<span id="cb40-139"><a href="#cb40-139" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb40-140"><a href="#cb40-140" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Autocorrelation plots for every model for every species</span></span>
<span id="cb40-141"><a href="#cb40-141" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cairo_pdf</span>(<span class="fu">paste</span>(gpwd, <span class="st">"/autocorr.pdf"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">family =</span> <span class="st">"Times"</span>)</span>
<span id="cb40-142"><a href="#cb40-142" aria-hidden="true" tabindex="-1"></a>        gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> autocorr_plots[[species[i]]], <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb40-143"><a href="#cb40-143" aria-hidden="true" tabindex="-1"></a>      <span class="fu">dev.off</span>()</span>
<span id="cb40-144"><a href="#cb40-144" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb40-145"><a href="#cb40-145" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Generation of the ellipses</span></span>
<span id="cb40-146"><a href="#cb40-146" aria-hidden="true" tabindex="-1"></a>      sea_b[[species[i]]] <span class="ot">&lt;-</span> <span class="fu">siberEllipses</span>(ellipses[[species[i]]])</span>
<span id="cb40-147"><a href="#cb40-147" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb40-148"><a href="#cb40-148" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Fill the data.frame with the SEAb data</span></span>
<span id="cb40-149"><a href="#cb40-149" aria-hidden="true" tabindex="-1"></a>      sea_bt <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sea_bt,</span>
<span id="cb40-150"><a href="#cb40-150" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">cbind</span>(reshape2<span class="sc">::</span><span class="fu">melt</span>(<span class="fu">as.data.frame</span>(sea_b[[species[i]]])),</span>
<span id="cb40-151"><a href="#cb40-151" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sp_col =</span> species[i]))</span>
<span id="cb40-152"><a href="#cb40-152" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="sc">==</span> <span class="fu">max</span>(<span class="fu">seq_along</span>(species))) {<span class="fu">colnames</span>(sea_bt) <span class="ot">&lt;-</span> <span class="fu">c</span>(var_col, <span class="st">"SEAb"</span>, sp_col)}</span>
<span id="cb40-153"><a href="#cb40-153" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb40-154"><a href="#cb40-154" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb40-155"><a href="#cb40-155" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create a data.frame to store the hdis</span></span>
<span id="cb40-156"><a href="#cb40-156" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate posterior means</span></span>
<span id="cb40-157"><a href="#cb40-157" aria-hidden="true" tabindex="-1"></a>      means <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">apply</span>(sea_b[[species[i]]], <span class="dv">2</span>, <span class="at">FUN =</span> mean))))</span>
<span id="cb40-158"><a href="#cb40-158" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate hdis</span></span>
<span id="cb40-159"><a href="#cb40-159" aria-hidden="true" tabindex="-1"></a>      hdi <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">apply</span>(sea_b[[species[i]]], <span class="dv">2</span>, <span class="at">FUN =</span> HDInterval<span class="sc">::</span>hdi))))</span>
<span id="cb40-160"><a href="#cb40-160" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Put the results in a data.frame</span></span>
<span id="cb40-161"><a href="#cb40-161" aria-hidden="true" tabindex="-1"></a>      temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(hdi, means, <span class="at">sp =</span> species[i])</span>
<span id="cb40-162"><a href="#cb40-162" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb40-163"><a href="#cb40-163" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Fill the data.frame with the results</span></span>
<span id="cb40-164"><a href="#cb40-164" aria-hidden="true" tabindex="-1"></a>      hdis <span class="ot">&lt;-</span> <span class="fu">rbind</span>(hdis, temp)</span>
<span id="cb40-165"><a href="#cb40-165" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb40-166"><a href="#cb40-166" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="sc">==</span> <span class="fu">max</span>(<span class="fu">seq_along</span>(species))) {hdis[var_col] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"V"</span>, <span class="fu">rep</span>(<span class="fu">seq_along</span>(model_files)), <span class="at">sep =</span> <span class="st">""</span>)}</span>
<span id="cb40-167"><a href="#cb40-167" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb40-168"><a href="#cb40-168" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Compute the posterior SEAb differences</span></span>
<span id="cb40-169"><a href="#cb40-169" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (k <span class="cf">in</span> <span class="fu">seq_along</span>(comps<span class="sc">$</span>a)) {</span>
<span id="cb40-170"><a href="#cb40-170" aria-hidden="true" tabindex="-1"></a>        a <span class="ot">&lt;-</span> comps<span class="sc">$</span>a[k]</span>
<span id="cb40-171"><a href="#cb40-171" aria-hidden="true" tabindex="-1"></a>        b <span class="ot">&lt;-</span> comps<span class="sc">$</span>b[k]</span>
<span id="cb40-172"><a href="#cb40-172" aria-hidden="true" tabindex="-1"></a>        comp <span class="ot">&lt;-</span> <span class="fu">paste</span>(lbls[a], <span class="st">"-"</span>, lbls[b])</span>
<span id="cb40-173"><a href="#cb40-173" aria-hidden="true" tabindex="-1"></a>        diff <span class="ot">&lt;-</span> sea_b[[species[i]]][, a] <span class="sc">-</span> sea_b[[species[i]]][, b]</span>
<span id="cb40-174"><a href="#cb40-174" aria-hidden="true" tabindex="-1"></a>        sup <span class="ot">&lt;-</span> <span class="fu">subset</span>(diff, diff<span class="sc">&gt;</span><span class="dv">0</span>, <span class="at">select =</span> diff)</span>
<span id="cb40-175"><a href="#cb40-175" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-176"><a href="#cb40-176" aria-hidden="true" tabindex="-1"></a>        diffs <span class="ot">&lt;-</span> <span class="fu">rbind</span>(diffs,</span>
<span id="cb40-177"><a href="#cb40-177" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">data.frame</span>(<span class="at">comp =</span> comp,</span>
<span id="cb40-178"><a href="#cb40-178" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">diff =</span> diff,</span>
<span id="cb40-179"><a href="#cb40-179" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">sp =</span> species[i]))</span>
<span id="cb40-180"><a href="#cb40-180" aria-hidden="true" tabindex="-1"></a>        diff_glob <span class="ot">&lt;-</span> <span class="fu">rbind</span>(diff_glob,</span>
<span id="cb40-181"><a href="#cb40-181" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">data.frame</span>(<span class="at">comp =</span> comp,</span>
<span id="cb40-182"><a href="#cb40-182" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">mean =</span> <span class="fu">mean</span>(diff),</span>
<span id="cb40-183"><a href="#cb40-183" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">IQr =</span> <span class="fu">t</span>(HDInterval<span class="sc">::</span><span class="fu">hdi</span>(diff, <span class="at">credMass =</span> <span class="fl">0.5</span>)),</span>
<span id="cb40-184"><a href="#cb40-184" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">hdi =</span> <span class="fu">t</span>(HDInterval<span class="sc">::</span><span class="fu">hdi</span>(diff, <span class="at">credMass =</span> <span class="fl">0.95</span>)),</span>
<span id="cb40-185"><a href="#cb40-185" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">sp =</span> species[i]</span>
<span id="cb40-186"><a href="#cb40-186" aria-hidden="true" tabindex="-1"></a>                                      )</span>
<span id="cb40-187"><a href="#cb40-187" aria-hidden="true" tabindex="-1"></a>                           )</span>
<span id="cb40-188"><a href="#cb40-188" aria-hidden="true" tabindex="-1"></a>        p_sup <span class="ot">&lt;-</span> <span class="fu">rbind</span>(p_sup,</span>
<span id="cb40-189"><a href="#cb40-189" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">data.frame</span>(<span class="at">comp =</span> comp,</span>
<span id="cb40-190"><a href="#cb40-190" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">p_sup =</span> (<span class="fu">length</span>(sup)<span class="sc">/</span><span class="fu">length</span>(diff))<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb40-191"><a href="#cb40-191" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">sp =</span> species[i]))</span>
<span id="cb40-192"><a href="#cb40-192" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb40-193"><a href="#cb40-193" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-194"><a href="#cb40-194" aria-hidden="true" tabindex="-1"></a>    diff_glob<span class="sc">$</span>comp <span class="ot">&lt;-</span> <span class="fu">factor</span>(diff_glob<span class="sc">$</span>comp, <span class="at">ordered =</span> T)</span>
<span id="cb40-195"><a href="#cb40-195" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb40-196"><a href="#cb40-196" aria-hidden="true" tabindex="-1"></a>    }<span class="co"># End of species loop</span></span>
<span id="cb40-197"><a href="#cb40-197" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-198"><a href="#cb40-198" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Violin plot of SEAb</span></span>
<span id="cb40-199"><a href="#cb40-199" aria-hidden="true" tabindex="-1"></a>    seab <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb40-200"><a href="#cb40-200" aria-hidden="true" tabindex="-1"></a>              <span class="fu">geom_violin</span>(<span class="at">data =</span> sea_bt, <span class="fu">aes_string</span>(<span class="at">x =</span> var_col, <span class="at">y =</span> <span class="st">"SEAb"</span>, <span class="at">fill =</span> var_col, <span class="at">color =</span> var_col),</span>
<span id="cb40-201"><a href="#cb40-201" aria-hidden="true" tabindex="-1"></a>                          <span class="at">show.legend =</span> F, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb40-202"><a href="#cb40-202" aria-hidden="true" tabindex="-1"></a>              <span class="fu">geom_boxplot</span>(<span class="at">data =</span> sea_bt,</span>
<span id="cb40-203"><a href="#cb40-203" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">aes_string</span>(<span class="at">x =</span> var_col, <span class="at">y =</span> <span class="st">"SEAb"</span>, <span class="at">fill =</span> var_col, <span class="at">color =</span> var_col),</span>
<span id="cb40-204"><a href="#cb40-204" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.05</span>, <span class="at">notch =</span> T, <span class="at">show.legend =</span> F,</span>
<span id="cb40-205"><a href="#cb40-205" aria-hidden="true" tabindex="-1"></a>                           <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">coef =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb40-206"><a href="#cb40-206" aria-hidden="true" tabindex="-1"></a>              <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> global_colors) <span class="sc">+</span></span>
<span id="cb40-207"><a href="#cb40-207" aria-hidden="true" tabindex="-1"></a>              <span class="fu">scale_color_manual</span>(<span class="at">values =</span> global_colors) <span class="sc">+</span></span>
<span id="cb40-208"><a href="#cb40-208" aria-hidden="true" tabindex="-1"></a>              <span class="co"># geom_linerange(data = hdi,</span></span>
<span id="cb40-209"><a href="#cb40-209" aria-hidden="true" tabindex="-1"></a>              <span class="co">#                aes_string(x = var_col, ymin = "lower", ymax = "upper", color = var_col),</span></span>
<span id="cb40-210"><a href="#cb40-210" aria-hidden="true" tabindex="-1"></a>              <span class="co">#                show.legend = F) + # Fix needed</span></span>
<span id="cb40-211"><a href="#cb40-211" aria-hidden="true" tabindex="-1"></a>              <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb40-212"><a href="#cb40-212" aria-hidden="true" tabindex="-1"></a>              <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb40-213"><a href="#cb40-213" aria-hidden="true" tabindex="-1"></a>                    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb40-214"><a href="#cb40-214" aria-hidden="true" tabindex="-1"></a>                    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb40-215"><a href="#cb40-215" aria-hidden="true" tabindex="-1"></a>                    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.15</span>),</span>
<span id="cb40-216"><a href="#cb40-216" aria-hidden="true" tabindex="-1"></a>                    <span class="at">legend.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb40-217"><a href="#cb40-217" aria-hidden="true" tabindex="-1"></a>              <span class="fu">labs</span>(<span class="at">x =</span> gp_label,</span>
<span id="cb40-218"><a href="#cb40-218" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fu">expression</span>(<span class="st">"SEAb "</span> (<span class="st">'\u2030'</span> <span class="sc">^</span><span class="dv">2</span>) )) <span class="sc">+</span></span>
<span id="cb40-219"><a href="#cb40-219" aria-hidden="true" tabindex="-1"></a>              <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> lbls) <span class="sc">+</span></span>
<span id="cb40-220"><a href="#cb40-220" aria-hidden="true" tabindex="-1"></a>              <span class="fu">facet_wrap</span>(<span class="fu">paste</span>(<span class="st">".~"</span>, sp_col, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>)</span>
<span id="cb40-221"><a href="#cb40-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-222"><a href="#cb40-222" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cairo_pdf</span>(<span class="fu">paste</span>(wd, <span class="st">"SEAb.pdf"</span>, <span class="at">sep =</span> <span class="st">"/"</span>), <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">width =</span> <span class="dv">8</span>)</span>
<span id="cb40-223"><a href="#cb40-223" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(seab)</span>
<span id="cb40-224"><a href="#cb40-224" aria-hidden="true" tabindex="-1"></a>      <span class="fu">dev.off</span>()</span>
<span id="cb40-225"><a href="#cb40-225" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb40-226"><a href="#cb40-226" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"All models have been run. Check your working directory for the results"</span>)</span>
<span id="cb40-227"><a href="#cb40-227" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">summaries =</span> summaries,</span>
<span id="cb40-228"><a href="#cb40-228" aria-hidden="true" tabindex="-1"></a>                <span class="at">sea_b =</span> sea_b,</span>
<span id="cb40-229"><a href="#cb40-229" aria-hidden="true" tabindex="-1"></a>                <span class="at">sea_bt =</span> sea_bt,</span>
<span id="cb40-230"><a href="#cb40-230" aria-hidden="true" tabindex="-1"></a>                <span class="at">hdis =</span> hdis,</span>
<span id="cb40-231"><a href="#cb40-231" aria-hidden="true" tabindex="-1"></a>                <span class="at">diffs =</span> diffs,</span>
<span id="cb40-232"><a href="#cb40-232" aria-hidden="true" tabindex="-1"></a>                <span class="at">diff_glob =</span> diff_glob,</span>
<span id="cb40-233"><a href="#cb40-233" aria-hidden="true" tabindex="-1"></a>                <span class="at">p_sup =</span> p_sup,</span>
<span id="cb40-234"><a href="#cb40-234" aria-hidden="true" tabindex="-1"></a>                <span class="at">ellips =</span> ellipses))</span>
<span id="cb40-235"><a href="#cb40-235" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sex" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="sex"><span class="header-section-number">3.4.2</span> Sex</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>lbls <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>sex_siber <span class="ot">&lt;-</span> <span class="fu">custom_siber</span>(full_set, <span class="at">var_col =</span> <span class="st">"sexo"</span>, lbls, <span class="at">sp_col =</span> <span class="st">"sp"</span>, <span class="at">n.burnin =</span> <span class="dv">7000</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">colors =</span> global_colors, <span class="at">gp_label =</span> <span class="st">"Sex"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 37
   Unobserved stochastic nodes: 3
   Total graph size: 52

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 44
   Unobserved stochastic nodes: 3
   Total graph size: 59

Initializing model</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No id variables; using all as measure variables</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 55
   Unobserved stochastic nodes: 3
   Total graph size: 70

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 14
   Unobserved stochastic nodes: 3
   Total graph size: 29

Initializing model</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No id variables; using all as measure variables</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 31
   Unobserved stochastic nodes: 3
   Total graph size: 46

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 43
   Unobserved stochastic nodes: 3
   Total graph size: 58

Initializing model</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No id variables; using all as measure variables</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
ℹ Please use tidy evaluation ideoms with `aes()`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "All models have been run. Check your working directory for the results"</code></pre>
</div>
</div>
<p>Eccentricities:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>ecc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (sp <span class="cf">in</span> <span class="fu">seq_along</span>(species)) {</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(lbls)) {</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    ecc <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ecc,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">data.frame</span>(<span class="at">sp =</span> species[sp],</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">j =</span> lbls[j],</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ecc =</span> <span class="fu">apply</span>(sex_siber<span class="sc">$</span>ellips[[species[sp]]][[j]][,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">1</span>, mat_ecc),</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">theta =</span> <span class="fu">apply</span>(sex_siber<span class="sc">$</span>ellips[[species[sp]]][[j]][,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">1</span>, mat_theta)))</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>ec <span class="ot">&lt;-</span> ecc <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sp, j) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">IQR.lower =</span> <span class="fu">hdi</span>(ecc, <span class="at">credMass =</span> <span class="fl">0.5</span>)[<span class="dv">1</span>],</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">IQR.upper =</span> <span class="fu">hdi</span>(ecc, <span class="at">credMass =</span> <span class="fl">0.5</span>)[<span class="dv">2</span>],</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">hdi.lower =</span> <span class="fu">hdi</span>(ecc)[<span class="dv">1</span>],</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">hdi.upper =</span> <span class="fu">hdi</span>(ecc)[<span class="dv">2</span>],</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">mean =</span> <span class="fu">mean</span>(ecc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'sp'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>ec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sp"],"name":[1],"type":["chr"],"align":["left"]},{"label":["j"],"name":[2],"type":["chr"],"align":["left"]},{"label":["IQR.lower"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["IQR.upper"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["hdi.lower"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["hdi.upper"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"H.dipterurus","2":"Female","3":"0.7986122","4":"0.8766134","5":"0.6708365","6":"0.9282140","7":"0.8115290"},{"1":"H.dipterurus","2":"Male","3":"0.8477495","4":"0.9050829","5":"0.7580003","6":"0.9334286","7":"0.8540716"},{"1":"N.entemedor","2":"Female","3":"0.8856926","4":"0.9227566","5":"0.8272791","6":"0.9453893","7":"0.8928585"},{"1":"N.entemedor","2":"Male","3":"0.9307245","4":"0.9707453","5":"0.8463764","6":"0.9882782","7":"0.9283918"},{"1":"R.steindachneri","2":"Female","3":"0.9051625","4":"0.9442397","5":"0.8407272","6":"0.9660087","7":"0.9106942"},{"1":"R.steindachneri","2":"Male","3":"0.9327158","4":"0.9565876","5":"0.8989952","6":"0.9727615","7":"0.9376534"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ecc, <span class="fu">aes</span>(<span class="at">x =</span> j, <span class="at">y =</span> ecc, <span class="at">group =</span> j, <span class="at">color =</span> <span class="fu">factor</span>(j))) <span class="sc">+</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_point(aes(x = sp, y = mean), data = ag, show.legend = F) +</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_errorbar(aes(x = sp, ymin = IQ.lower, ymax = IQ.upper, group = sp), data = ag) +</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SEAB Eccentricity"</span>,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> global_colors) <span class="sc">+</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.1</span>),</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ES3_SIBER_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Theta:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>th <span class="ot">&lt;-</span> ecc <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sp, j) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">IQR.lower =</span> <span class="fu">hdi</span>(theta, <span class="at">credMass =</span> <span class="fl">0.5</span>)[<span class="dv">1</span>],</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">IQR.upper =</span> <span class="fu">hdi</span>(theta, <span class="at">credMass =</span> <span class="fl">0.5</span>)[<span class="dv">2</span>],</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">hdi.lower =</span> <span class="fu">hdi</span>(theta)[<span class="dv">1</span>],</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">hdi.upper =</span> <span class="fu">hdi</span>(theta)[<span class="dv">2</span>],</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">mean =</span> <span class="fu">mean</span>(theta))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'sp'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sp"],"name":[1],"type":["chr"],"align":["left"]},{"label":["j"],"name":[2],"type":["chr"],"align":["left"]},{"label":["IQR.lower"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["IQR.upper"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["hdi.lower"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["hdi.upper"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"H.dipterurus","2":"Female","3":"-1.0607003","4":"-0.8630260","5":"-1.2827720","6":"-0.6795458","7":"-0.9713643"},{"1":"H.dipterurus","2":"Male","3":"-0.9742833","4":"-0.8310536","5":"-1.1202795","6":"-0.6889880","7":"-0.9040297"},{"1":"N.entemedor","2":"Female","3":"-1.0344454","4":"-0.9332269","5":"-1.1297363","6":"-0.8289070","7":"-0.9775306"},{"1":"N.entemedor","2":"Male","3":"-1.1628516","4":"-1.0166374","5":"-1.3201845","6":"-0.8391161","7":"-1.0832158"},{"1":"R.steindachneri","2":"Female","3":"-1.1005927","4":"-0.9838180","5":"-1.2303093","6":"-0.8687249","7":"-1.0405127"},{"1":"R.steindachneri","2":"Male","3":"-0.8790313","4":"-0.8024840","5":"-0.9487323","6":"-0.7156597","7":"-0.8386373"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ecc, <span class="fu">aes</span>(<span class="at">x =</span> j, <span class="at">y =</span> theta, <span class="at">group =</span> j, <span class="at">color =</span> <span class="fu">factor</span>(j))) <span class="sc">+</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_point(aes(x = sp, y = mean), data = ag, show.legend = F) +</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_errorbar(aes(x = sp, ymin = IQ.lower, ymax = IQ.upper, group = sp), data = ag) +</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SEAB theta"</span>,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> global_colors) <span class="sc">+</span> </span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.1</span>),</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ES3_SIBER_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="age" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="age"><span class="header-section-number">3.4.3</span> Age</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>lbls <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Adult"</span>, <span class="st">"Juvenile"</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>age_siber <span class="ot">&lt;-</span> <span class="fu">custom_siber</span>(full_set, <span class="at">var_col =</span> <span class="st">"estadio"</span>, lbls, <span class="at">sp_col =</span> <span class="st">"sp"</span>, <span class="at">n.burnin =</span> <span class="dv">7000</span>,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">colors =</span> global_colors, <span class="at">gp_label =</span> <span class="st">"Age"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 45
   Unobserved stochastic nodes: 3
   Total graph size: 60

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 36
   Unobserved stochastic nodes: 3
   Total graph size: 51

Initializing model</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No id variables; using all as measure variables</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 55
   Unobserved stochastic nodes: 3
   Total graph size: 70

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 14
   Unobserved stochastic nodes: 3
   Total graph size: 29

Initializing model</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No id variables; using all as measure variables</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 48
   Unobserved stochastic nodes: 3
   Total graph size: 63

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 26
   Unobserved stochastic nodes: 3
   Total graph size: 41

Initializing model</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No id variables; using all as measure variables</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "All models have been run. Check your working directory for the results"</code></pre>
</div>
</div>
<p>Eccenctricities:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>ecc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (sp <span class="cf">in</span> <span class="fu">seq_along</span>(species)) {</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(lbls)) {</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    ecc <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ecc,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">data.frame</span>(<span class="at">sp =</span> species[sp],</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">j =</span> lbls[j],</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ecc =</span> <span class="fu">apply</span>(age_siber<span class="sc">$</span>ellips[[species[sp]]][[j]][,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">1</span>, mat_ecc),</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">theta =</span> <span class="fu">apply</span>(age_siber<span class="sc">$</span>ellips[[species[sp]]][[j]][,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">1</span>, mat_theta)))</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>ec <span class="ot">&lt;-</span> ecc <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sp, j) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">IQR.lower =</span> <span class="fu">hdi</span>(ecc, <span class="at">credMass =</span> <span class="fl">0.5</span>)[<span class="dv">1</span>],</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">IQR.upper =</span> <span class="fu">hdi</span>(ecc, <span class="at">credMass =</span> <span class="fl">0.5</span>)[<span class="dv">2</span>],</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">hdi.lower =</span> <span class="fu">hdi</span>(ecc)[<span class="dv">1</span>],</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">hdi.upper =</span> <span class="fu">hdi</span>(ecc)[<span class="dv">2</span>],</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">mean =</span> <span class="fu">mean</span>(ecc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'sp'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>ec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sp"],"name":[1],"type":["chr"],"align":["left"]},{"label":["j"],"name":[2],"type":["chr"],"align":["left"]},{"label":["IQR.lower"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["IQR.upper"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["hdi.lower"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["hdi.upper"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"H.dipterurus","2":"Adult","3":"0.8314943","4":"0.8928421","5":"0.7354835","6":"0.9325767","7":"0.8401111"},{"1":"H.dipterurus","2":"Juvenile","3":"0.8224495","4":"0.8948920","5":"0.6956805","6":"0.9297672","7":"0.8294799"},{"1":"N.entemedor","2":"Adult","3":"0.8962080","4":"0.9299038","5":"0.8511269","6":"0.9539392","7":"0.9048060"},{"1":"N.entemedor","2":"Juvenile","3":"0.9393646","4":"0.9754857","5":"0.8589136","6":"0.9880729","7":"0.9351916"},{"1":"R.steindachneri","2":"Adult","3":"0.9327185","4":"0.9555065","5":"0.8993233","6":"0.9701197","7":"0.9370595"},{"1":"R.steindachneri","2":"Juvenile","3":"0.9205810","4":"0.9562880","5":"0.8568797","6":"0.9750158","7":"0.9230535"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ecc, <span class="fu">aes</span>(<span class="at">x =</span> j, <span class="at">y =</span> ecc, <span class="at">group =</span> j, <span class="at">color =</span> <span class="fu">factor</span>(j))) <span class="sc">+</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_point(aes(x = sp, y = mean), data = ag, show.legend = F) +</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_errorbar(aes(x = sp, ymin = IQ.lower, ymax = IQ.upper, group = sp), data = ag) +</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SEAB Eccentricity"</span>,</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> global_colors) <span class="sc">+</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.1</span>),</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ES3_SIBER_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Theta:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>th <span class="ot">&lt;-</span> ecc <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sp, j) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">IQR.lower =</span> <span class="fu">hdi</span>(theta, <span class="at">credMass =</span> <span class="fl">0.5</span>)[<span class="dv">1</span>],</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">IQR.upper =</span> <span class="fu">hdi</span>(theta, <span class="at">credMass =</span> <span class="fl">0.5</span>)[<span class="dv">2</span>],</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">hdi.lower =</span> <span class="fu">hdi</span>(theta)[<span class="dv">1</span>],</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">hdi.upper =</span> <span class="fu">hdi</span>(theta)[<span class="dv">2</span>],</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">mean =</span> <span class="fu">mean</span>(theta))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'sp'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sp"],"name":[1],"type":["chr"],"align":["left"]},{"label":["j"],"name":[2],"type":["chr"],"align":["left"]},{"label":["IQR.lower"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["IQR.upper"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["hdi.lower"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["hdi.upper"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"H.dipterurus","2":"Adult","3":"-1.0320431","4":"-0.8790116","5":"-1.197893","6":"-0.7336722","7":"-0.9603651"},{"1":"H.dipterurus","2":"Juvenile","3":"-1.0617646","4":"-0.8836716","5":"-1.279276","6":"-0.7149555","7":"-0.9772553"},{"1":"N.entemedor","2":"Adult","3":"-1.1475527","4":"-1.0534157","5":"-1.235275","6":"-0.9536928","7":"-1.0998811"},{"1":"N.entemedor","2":"Juvenile","3":"-1.0011011","4":"-0.8602375","5":"-1.166740","6":"-0.7234025","7":"-0.9357849"},{"1":"R.steindachneri","2":"Adult","3":"-0.9441168","4":"-0.8679945","5":"-1.019879","6":"-0.7920532","7":"-0.9077011"},{"1":"R.steindachneri","2":"Juvenile","3":"-0.8952016","4":"-0.7784846","5":"-1.012304","6":"-0.6588858","7":"-0.8339125"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ecc, <span class="fu">aes</span>(<span class="at">x =</span> j, <span class="at">y =</span> theta, <span class="at">group =</span> j, <span class="at">color =</span> <span class="fu">factor</span>(j))) <span class="sc">+</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_point(aes(x = sp, y = mean), data = ag, show.legend = F) +</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_errorbar(aes(x = sp, ymin = IQ.lower, ymax = IQ.upper, group = sp), data = ag) +</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SEAB theta"</span>,</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> global_colors) <span class="sc">+</span> </span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.1</span>),</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ES3_SIBER_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="season" class="level3" data-number="3.4.4">
<h3 data-number="3.4.4" class="anchored" data-anchor-id="season"><span class="header-section-number">3.4.4</span> Season</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>lbls <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Warm"</span>, <span class="st">"Cold"</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>season_siber <span class="ot">&lt;-</span> <span class="fu">custom_siber</span>(full_set, <span class="at">var_col =</span> <span class="st">"temporada"</span>, lbls, <span class="at">sp_col =</span> <span class="st">"sp"</span>,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">colors =</span> global_colors, <span class="at">gp_label =</span> <span class="st">"Season"</span>,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">n.burnin =</span> <span class="dv">750000</span>, <span class="at">n.iter =</span> <span class="dv">10000</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Too few points to calculate an ellipse</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values (`geom_path()`).</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 63
   Unobserved stochastic nodes: 3
   Total graph size: 78

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 18
   Unobserved stochastic nodes: 3
   Total graph size: 33

Initializing model</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No id variables; using all as measure variables</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 15
   Unobserved stochastic nodes: 3
   Total graph size: 30

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 54
   Unobserved stochastic nodes: 3
   Total graph size: 69

Initializing model</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No id variables; using all as measure variables</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in createSiberObject(subdata[subdata[, sp_col] == species[i], 3:6]): At least one of your groups has less than 5 observations.
          The absolute minimum sample size for each group is 3 in order
          for the various ellipses and corresponding metrics to be 
          calculated. More reasonably though, a minimum of 5 data points
          are required to calculate the two means and the 2x2 covariance 
          matrix and not run out of degrees of freedom. Check the item 
          named 'sample.sizes' in the object returned by this function 
          in order to locate the offending group. Bear in mind that NAs in 
          the sample.size matrix simply indicate groups that are not 
          present in that community, and is an acceptable data structure 
          for these analyses.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 71
   Unobserved stochastic nodes: 3
   Total graph size: 86

Initializing model

Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 3
   Unobserved stochastic nodes: 3
   Total graph size: 18

Initializing model</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No id variables; using all as measure variables</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "All models have been run. Check your working directory for the results"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>ecc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (sp <span class="cf">in</span> <span class="fu">seq_along</span>(species)) {</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(lbls)) {</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    ecc <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ecc,</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">data.frame</span>(<span class="at">sp =</span> species[sp],</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">j =</span> lbls[j],</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ecc =</span> <span class="fu">apply</span>(season_siber<span class="sc">$</span>ellips[[species[sp]]][[j]][,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">1</span>, mat_ecc),</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">theta =</span> <span class="fu">apply</span>(season_siber<span class="sc">$</span>ellips[[species[sp]]][[j]][,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">1</span>, mat_theta)))</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>ec <span class="ot">&lt;-</span> ecc <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sp, j) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">IQR.lower =</span> <span class="fu">hdi</span>(ecc, <span class="at">credMass =</span> <span class="fl">0.5</span>)[<span class="dv">1</span>],</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">IQR.upper =</span> <span class="fu">hdi</span>(ecc, <span class="at">credMass =</span> <span class="fl">0.5</span>)[<span class="dv">2</span>],</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">hdi.lower =</span> <span class="fu">hdi</span>(ecc)[<span class="dv">1</span>],</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">hdi.upper =</span> <span class="fu">hdi</span>(ecc)[<span class="dv">2</span>],</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">mean =</span> <span class="fu">mean</span>(ecc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'sp'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>ec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sp"],"name":[1],"type":["chr"],"align":["left"]},{"label":["j"],"name":[2],"type":["chr"],"align":["left"]},{"label":["IQR.lower"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["IQR.upper"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["hdi.lower"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["hdi.upper"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"H.dipterurus","2":"Cold","3":"0.7637916","4":"0.8861268","5":"0.5276031","6":"0.9451712","7":"0.7710202"},{"1":"H.dipterurus","2":"Warm","3":"0.8340529","4":"0.8859804","5":"0.7550256","6":"0.9180242","7":"0.8455248"},{"1":"N.entemedor","2":"Cold","3":"0.9125254","4":"0.9407318","5":"0.8726231","6":"0.9598755","7":"0.9190839"},{"1":"N.entemedor","2":"Warm","3":"0.7891755","4":"0.9081083","5":"0.5487911","6":"0.9569354","7":"0.7876360"},{"1":"R.steindachneri","2":"Cold","3":"0.9492911","4":"0.9985633","5":"0.7291594","6":"0.9998733","7":"0.9186087"},{"1":"R.steindachneri","2":"Warm","3":"0.9223005","4":"0.9446856","5":"0.8918375","6":"0.9592863","7":"0.9282434"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ecc, <span class="fu">aes</span>(<span class="at">x =</span> j, <span class="at">y =</span> ecc, <span class="at">group =</span> j, <span class="at">color =</span> <span class="fu">factor</span>(j))) <span class="sc">+</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_point(aes(x = sp, y = mean), data = ag, show.legend = F) +</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_errorbar(aes(x = sp, ymin = IQ.lower, ymax = IQ.upper, group = sp), data = ag) +</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SEAB Eccentricity"</span>,</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> global_colors) <span class="sc">+</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.1</span>),</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ES3_SIBER_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Theta:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>th <span class="ot">&lt;-</span> ecc <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sp, j) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">IQR.lower =</span> <span class="fu">hdi</span>(theta, <span class="at">credMass =</span> <span class="fl">0.5</span>)[<span class="dv">1</span>],</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">IQR.upper =</span> <span class="fu">hdi</span>(theta, <span class="at">credMass =</span> <span class="fl">0.5</span>)[<span class="dv">2</span>],</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">hdi.lower =</span> <span class="fu">hdi</span>(theta)[<span class="dv">1</span>],</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">hdi.upper =</span> <span class="fu">hdi</span>(theta)[<span class="dv">2</span>],</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">mean =</span> <span class="fu">mean</span>(theta))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'sp'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sp"],"name":[1],"type":["chr"],"align":["left"]},{"label":["j"],"name":[2],"type":["chr"],"align":["left"]},{"label":["IQR.lower"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["IQR.upper"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["hdi.lower"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["hdi.upper"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"H.dipterurus","2":"Cold","3":"-1.2027414","4":"-0.8457751","5":"-1.570790","6":"-0.0748726","7":"-0.9006982"},{"1":"H.dipterurus","2":"Warm","3":"-1.0633377","4":"-0.9383704","5":"-1.192232","6":"-0.8136940","7":"-1.0014959"},{"1":"N.entemedor","2":"Cold","3":"-1.0779714","4":"-0.9938467","5":"-1.159170","6":"-0.9079133","7":"-1.0332083"},{"1":"N.entemedor","2":"Warm","3":"-1.1384850","4":"-0.7802354","5":"-1.569606","6":"-0.1452550","7":"-0.8617354"},{"1":"R.steindachneri","2":"Cold","3":"-0.6631362","4":"-0.3219227","5":"-1.251994","6":"0.2903891","7":"-0.4540961"},{"1":"R.steindachneri","2":"Warm","3":"-0.9575943","4":"-0.8892206","5":"-1.028782","6":"-0.8264072","7":"-0.9270705"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ecc, <span class="fu">aes</span>(<span class="at">x =</span> j, <span class="at">y =</span> theta, <span class="at">group =</span> j, <span class="at">color =</span> <span class="fu">factor</span>(j))) <span class="sc">+</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_point(aes(x = sp, y = mean), data = ag, show.legend = F) +</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_errorbar(aes(x = sp, ymin = IQ.lower, ymax = IQ.upper, group = sp), data = ag) +</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SEAB theta"</span>,</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> global_colors) <span class="sc">+</span> </span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.1</span>),</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ES3_SIBER_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="final-forestplot" class="level3" data-number="3.4.5">
<h3 data-number="3.4.5" class="anchored" data-anchor-id="final-forestplot"><span class="header-section-number">3.4.5</span> Final forestplot:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>forest_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(age_siber[[<span class="dv">6</span>]], season_siber[[<span class="dv">6</span>]], sex_siber[[<span class="dv">6</span>]])</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>forest <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> forest_data) <span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#C9C8C8"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">y =</span> comp, <span class="at">xmin =</span> IQr.lower, <span class="at">xmax =</span> IQr.upper),</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">color =</span> global_colors[<span class="dv">1</span>], <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">y =</span> comp, <span class="at">xmin =</span> hdi.lower, <span class="at">xmax =</span> hdi.upper),</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">color =</span> global_colors[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean, <span class="at">y =</span> comp), <span class="at">color =</span> global_colors[<span class="dv">1</span>], <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>               <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.15</span>),</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>               <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>sp)</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cairo_pdf</span>(<span class="st">"output/SIBER/forest_cats.pdf"</span>, <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">width =</span> <span class="dv">4</span>, <span class="at">height =</span> <span class="dv">2</span>)</span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>forest</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>quartz_off_screen 
                2 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>season_siber<span class="sc">$</span>p_sup</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["comp"],"name":[1],"type":["chr"],"align":["left"]},{"label":["p_sup"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sp"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"Warm - Cold","2":"59.48667","3":"H.dipterurus"},{"1":"Warm - Cold","2":"24.28333","3":"N.entemedor"},{"1":"Warm - Cold","2":"18.93667","3":"R.steindachneri"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>sex_siber<span class="sc">$</span>p_sup</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["comp"],"name":[1],"type":["chr"],"align":["left"]},{"label":["p_sup"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sp"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"Female - Male","2":"31.93333","3":"H.dipterurus"},{"1":"Female - Male","2":"12.10000","3":"N.entemedor"},{"1":"Female - Male","2":"20.13333","3":"R.steindachneri"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>age_siber<span class="sc">$</span>p_sup</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["comp"],"name":[1],"type":["chr"],"align":["left"]},{"label":["p_sup"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sp"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"Adult - Juvenile","2":"19.41667","3":"H.dipterurus"},{"1":"Adult - Juvenile","2":"0.35000","3":"N.entemedor"},{"1":"Adult - Juvenile","2":"78.23333","3":"R.steindachneri"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ES2_BHGLM.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Hierarchical Bayesian Models to describe differences in isotopic values between and within species</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ES4_nicheROVER.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Isotopic niche overlaps</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>